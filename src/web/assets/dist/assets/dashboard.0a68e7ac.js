/* empty css            */import{A as V,B as M,d as b,s as S,f as H,I as R,c as m,o as i,p as U,a as r,t as _,J as L,k as C,K as T,r as $,w as z,l as w,z as y,b as k,n as B,m as E,F as Y,G as K,H as G}from"./vendor.289525c3.js";import{_ as x,u as J}from"./plugin-vue_export-helper.d3242fce.js";var F,q;const Q=(q=(F=window==null?void 0:window.Attendee)==null?void 0:F.cpUrl)!=null?q:"https://researchschool.org.uk/cp";var D,P;const W=(P=(D=window==null?void 0:window.Attendee)==null?void 0:D.csrf)!=null?P:"",O=V("trainings",{state:()=>({events:null,attendees:null,followOnSupport:null,followOnSupportOptions:null,period:3,site:"main",loading:!1}),actions:{fetchEvents(e){const t=this;this.loading=!0,this.site,this.period;const d={CRAFT_CSRF_TOKEN:W,events:e};M({method:"post",url:`${Q}/actions/craft-attendees/dashboard/fetch`,data:d}).then(function(s){var p,u,o,a;t.loading=!1,t.events=(p=s==null?void 0:s.data)==null?void 0:p.events,t.attendees=(u=s==null?void 0:s.data)==null?void 0:u.attendees,t.followOnSupport=(o=s==null?void 0:s.data)==null?void 0:o.follow_on_support,t.followOnSupportOptions=(a=s==null?void 0:s.data)==null?void 0:a.follow_on_support_options})}}}),X=b({setup(){const e=O(),{loading:t,period:d}=S(e);return{loading:t,period:d,handlePeriodChanged:p=>{e.period=parseInt(p.currentTarget.value),e.fetchEvents()}}}}),Z=["disabled"],ee=U('<option value="2022">Academic Year (2021/22)</option><option value="2021">Academic Year (2020/21)</option><option value="2020">Academic Year (2019/20)</option><option value="3">Last 3 months</option><option value="6">Last 6 months</option>',5),te=[ee];function se(e,t,d,s,p,u){return H((i(),m("select",{name:"period",class:"block h-10 px-1 rounded-md bg-gray-300 border-gray-300","onUpdate:modelValue":t[0]||(t[0]=o=>e.period=o),disabled:e.loading,onChange:t[1]||(t[1]=(...o)=>e.handlePeriodChanged&&e.handlePeriodChanged(...o))},te,40,Z)),[[R,e.period]])}var oe=x(X,[["render",se]]);const ne=b({components:{dropdown:oe},props:{start:{type:String,required:!0},end:{type:String,required:!0}},setup(){const e=O(),{loading:t}=S(e);return{loading:t}}}),ae={class:"flex w-full sticky z-20 bg-gray-100 bg-opacity-70 py-4 backdrop-blur",style:{top:"50px"}},le={class:"text-xl font-bold inline-block flex-grow",style:{"margin-bottom":"0!important"}},re=C("Showing data from "),ie=C(" to "),ce={style:{"margin-top":"0!important"}};function de(e,t,d,s,p,u){return i(),m("div",ae,[r("p",le,[re,r("strong",null,_(e.start),1),ie,r("strong",null,_(e.end),1)]),r("div",ce,[L(e.$slots,"default")])])}var pe=x(ne,[["render",de]]);const ue=b({components:{apexchart:T},setup(){const e=$({chart:{id:"engagement-levels",stacked:!0,stackType:"100%"},plotOptions:{bar:{horizontal:!0}},theme:{palette:"palette3"},legend:{show:!1},xaxis:{labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{show:!1},colors:["#2b63eb","#113795"]}),t=$([{name:"Attendees",data:[0]},{name:"Attendees (100% verified)",data:[0]}]),d=J(),{loading:s,events:p,attendees:u}=S(d),o=$(0),a=$(0),g=$(0);return z(()=>{if(u.value){const v=u.value.reduce(function(h,l){return h[l.eventId]=h[l.eventId]||[],h[l.eventId].push(l),h},Object.create(null));o.value=Object.keys(v).length,Object.values(v).forEach((h,l)=>{a.value=a.value+h.length;let c=!0;for(const n in h)h[n].approved!=1&&(c=!1);c&&(g.value=g.value+1)}),t.value[0].data[0]=o.value,t.value[1].data[0]=g.value}}),{loading:s,chartOptions:e,series:t,events:p,allAttendees:o,totalAttendeesAreApproved:g,attendees:u}}}),he={class:"bg-white p-4 rounded-xl mb-4"},ge=r("p",{class:"font-bold text-lg"},"Engagement Data Completion",-1),ve={key:1,class:"text-xl w-full inline-block text-center text-gray-400"},me=C(" total training events, "),fe={key:2,class:"block relative flex items-center justify-center w-full",style:{height:"150px"}},ye=r("svg",{class:"animate-spin ml-2 mt-1 h-8 w-8 text-gray-400 inline-block -mt-px",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",style:{"margin-bottom":"0!important"}},[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),be=[ye];function _e(e,t,d,s,p,u){var a,g,v,h,l;const o=w("apexchart");return i(),m("article",he,[ge,!e.loading&&((a=e.attendees)==null?void 0:a.length)>0?(i(),y(o,{key:0,height:"150",type:"bar",options:e.chartOptions,series:e.series},null,8,["options","series"])):k("",!0),!e.loading&&((g=e.attendees)==null?void 0:g.length)===0?(i(),m("p",ve,"There is no data to preview")):k("",!0),r("span",{class:B(["block w-full text-center py-2",e.loading||((v=e.attendees)==null?void 0:v.length)===0?"opacity-0":""])},[r("strong",null,_((h=e.events)==null?void 0:h.length),1),me,r("strong",null,_(e.allAttendees),1),C(" have attendees and ("+_(((l=e.events)==null?void 0:l.length)/100*e.totalAttendeesAreApproved)+"%) are verified.",1)],2),e.loading?(i(),m("span",fe,be)):k("",!0)])}var $e=x(ue,[["render",_e]]);const we=b({props:{value:{type:Number,required:!0},type:{type:String,required:!0},average:{type:Number,required:!0},description:{type:String,required:!0}}}),ke={class:"bg-white rounded-xl p-4"},xe={class:"flex items-end pb-2",style:{"align-items":"end"}},Se={class:"text-6xl block text-blue-600",style:{"margin-bottom":"0!important"}},Oe={class:"block pb-1",style:{"margin-bottom":"0!important"}},Ae={class:"block pb-1 text-xs"},je=C("Avg. ");function Ce(e,t,d,s,p,u){return i(),m("article",ke,[r("span",xe,[r("span",Se,_(e.value),1),r("span",Oe,_(e.type),1)]),r("span",Ae,[je,r("strong",null,_(e.average),1),C(" "+_(e.description),1)])])}var Ne=x(we,[["render",Ce]]);const Ie=b({setup(){const e=O(),{loading:t}=S(e);return{loading:t}}}),Ee={class:"bg-white rounded-xl p-4"},Te={key:0},ze=r("span",{class:"animate-pulse flex items-end pb-2",style:{"align-items":"end"}},[r("span",{class:"text-6xl block text-blue-600 bg-blue-600 bg-opacity-10 rounded-md",style:{"margin-bottom":"0!important"}},"\xA0\xA0\xA0\xA0\xA0\xA0"),r("span",{class:"block pb-1 bg-gray-200 bg-opacity-50 flex-grow rounded-md",style:{"margin-bottom":"0!important"}},"\xA0")],-1),Be=r("span",{class:"animate-pulse block pb-1 text-xs bg-gray-200 bg-opacity-50 rounded-md"},"\xA0",-1),Fe=[ze,Be],qe={key:1,class:"flex items-center justify-center w-full h-full font-bold"};function De(e,t,d,s,p,u){return i(),m("article",Ee,[e.loading?(i(),m("div",Te,Fe)):(i(),m("div",qe," There is no data to preview "))])}var Pe=x(Ie,[["render",De]]);const Ve=b({components:{stat:Ne,"stat-empty":Pe},setup(){const e=O(),{loading:t,events:d,attendees:s,period:p}=S(e);return{loading:t,events:d,attendees:s,schools:()=>{const l=s.value.reduce(function(c,n){return c[n.orgName]=c[n.orgName]||[],c[n.orgName].push(n),c},Object.create(null));return Object.keys(l).length},priority:()=>{const l=s.value.reduce(function(c,n){return c[n.priority]=c[n.priority]||[],c[n.priority].push(n),c},Object.create(null));return isNaN(Object.keys(l).length)?0:Object.keys(l).length},averageEvents:()=>Math.ceil(d.value.length/p.value),averageAttendees:()=>{const l=s.value.reduce(function(n,f){return n[f.eventId]=n[f.eventId]||[],n[f.eventId].push(f),n},Object.create(null));let c=Object.values(l).map(n=>n.length);return c=Math.ceil(c.reduce((n,f)=>n+f,0)/c.length),isNaN(c)?0:c},averageSchools:()=>{var f;const l=s.value.reduce(function(A,j){return A[j.eventId]=A[j.eventId]||[],A[j.eventId].push(j),A},Object.create(null));let c=0;for(const A in l){const j=l[A].reduce(function(N,I){return N[I.orgName]=N[I.orgName]||[],N[I.orgName].push(I),N},Object.create(null));c+=Object.keys(j).length}const n=Math.ceil(c/((f=Object.keys(l))==null?void 0:f.length));return isNaN(n)?0:n},averagePrioritySchools:()=>{let l=s.value.filter(n=>n.priority===1);l=l.reduce(function(n,f){return n[f.eventId]=n[f.eventId]||[],n[f.eventId].push(f),n},Object.create(null));let c=Object.values(l).map(n=>n.length);return c=Math.ceil(c.reduce((n,f)=>n+f,0)/c.length),isNaN(c)?0:c}}}}),Me={class:"grid grid-cols-2 xl:grid-cols-4 gap-4"};function He(e,t,d,s,p,u){const o=w("stat"),a=w("stat-empty");return i(),m("div",Me,[e.events&&!e.loading?(i(),y(o,{key:0,value:e.events.length,average:e.averageEvents(),type:"events",description:"trainings per month"},null,8,["value","average"])):(i(),y(a,{key:1})),e.attendees&&!e.loading?(i(),y(o,{key:2,value:e.attendees.length,average:e.averageAttendees(),type:"attendees",description:"attendees per training"},null,8,["value","average"])):(i(),y(a,{key:3})),e.attendees&&!e.loading?(i(),y(o,{key:4,value:e.schools(),average:e.averageSchools(),type:"schools",description:"schools per training"},null,8,["value","average"])):(i(),y(a,{key:5})),e.attendees&&!e.loading?(i(),y(o,{key:6,value:e.priority(),average:e.averagePrioritySchools(),type:"priority schools",description:"priority schools per training"},null,8,["value","average"])):(i(),y(a,{key:7}))])}var Re=x(Ve,[["render",He]]);const Ue=b({components:{apexchart:T},setup(){const e=$({chart:{id:"engagement-levels",stacked:!0,stackType:"100%"},plotOptions:{bar:{horizontal:!0}},theme:{palette:"palette3"},legend:{position:"top"},xaxis:{labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{show:!1},colors:["#2b63eb","#113795","#07205b"]}),t=$([{name:"Engaged (1 module)",data:[0]},{name:"Sustained (2 modules)",data:[0]},{name:"Embedded (3+ modules)",data:[0]}]),d=O(),{loading:s,attendees:p}=S(d);return z(()=>{if(p.value){const u=p.value.reduce(function(o,a){return o[a.days]=o[a.days]||[],o[a.days].push(a),o},Object.create(null));for(const o in Object.keys(u)){const a=o<3?o:2;t.value[a].data[0]=parseInt(t.value[a].data[0])+Object.values(u)[o].length}}}),{loading:s,chartOptions:e,series:t,attendees:p}}}),Le={class:"bg-white p-4 rounded-xl mb-4"},Ye=r("p",{class:"font-bold text-lg"},"Engagement level",-1),Ke={key:1,class:"text-xl w-full inline-block text-center text-gray-400"},Ge={key:2,class:"block relative flex items-center justify-center w-full",style:{height:"150px"}},Je=r("svg",{class:"animate-spin ml-2 mt-1 h-8 w-8 text-gray-400 inline-block -mt-px",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",style:{"margin-bottom":"0!important"}},[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),Qe=[Je];function We(e,t,d,s,p,u){var a,g,v;const o=w("apexchart");return i(),m("article",Le,[Ye,!e.loading&&((a=e.attendees)==null?void 0:a.length)>0?(i(),y(o,{key:0,height:"150",type:"bar",options:e.chartOptions,series:e.series},null,8,["options","series"])):k("",!0),!e.loading&&((g=e.attendees)==null?void 0:g.length)===0?(i(),m("p",Ke,"There is no data to preview")):k("",!0),r("span",{class:B(["block w-full text-center py-2",e.loading||((v=e.attendees)==null?void 0:v.length)===0?"opacity-0":""])},"Showing the split of engagement levels across all events in this time period",2),e.loading?(i(),m("span",Ge,Qe)):k("",!0)])}var Xe=x(Ue,[["render",We]]);const Ze=b({components:{apexchart:T},setup(e){const t=$({chart:{id:"follow-on-support"},plotOptions:{bar:{horizontal:!0,height:"10%"}},theme:{palette:"palette3"},legend:{position:"top"},xaxis:{categories:[]},yaxis:{labels:{style:{fontSize:"14px",fontFamily:'system-ui,BlinkMacSystemFont,-apple-system,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif'}}},colors:["#2b63eb","#113795","#07205b"]}),d=$([{name:"Follow on support",data:[]}]),s=O(),{loading:p,followOnSupport:u,followOnSupportOptions:o}=S(s);return z(()=>{var a;if(u.value){const g=u.value.reduce(function(h,l){return h[l.optionId]=h[l.optionId]||[],h[l.optionId].push(l),h},Object.create(null));let v=[];for(const h in g)v.push((a=o.value.find(l=>l.id==h))==null?void 0:a.name);t.value.xaxis.categories=v,d.value[0].data=[],Object.values(g).forEach((h,l)=>{d.value[0].data.push(h.length)})}}),{chartOptions:t,series:d,loading:p,followOnSupport:u}}}),et={class:"bg-white p-4 rounded-xl mb-4"},tt=r("p",{class:"font-bold text-lg"},"Follow on support",-1),st={key:1,class:"text-xl w-full inline-block text-center text-gray-400 flex items-center justify-center w-full block",style:{height:"800px"}},ot=r("span",null,"There is no data to preview",-1),nt=[ot],at={key:2,class:"block relative flex items-center justify-center w-full",style:{height:"800px"}},lt=r("svg",{class:"animate-spin ml-2 mt-1 h-8 w-8 text-gray-400 inline-block -mt-px",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",style:{"margin-bottom":"0!important"}},[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),rt=[lt];function it(e,t,d,s,p,u){var a,g,v;const o=w("apexchart");return i(),m("article",et,[tt,!e.loading&&((a=e.followOnSupport)==null?void 0:a.length)>0?(i(),y(o,{key:0,height:"800px",type:"bar",options:e.chartOptions,series:e.series},null,8,["options","series"])):k("",!0),!e.loading&&((g=e.followOnSupport)==null?void 0:g.length)===0?(i(),m("p",st,nt)):k("",!0),r("span",{class:B(["block w-full text-center py-2",e.loading||((v=e.followOnSupport)==null?void 0:v.length)===0?"opacity-0":""])},"Showing what types of follow on support have been offered.",2),e.loading?(i(),m("span",at,rt)):k("",!0)])}var ct=x(Ze,[["render",it]]);const dt=b({components:{"stats-completion":$e,"stats-figures":Re,"stats-levels":Xe,"stats-support":ct},props:{site:{type:String,required:!0},ids:{type:String,required:!0}},setup(e){const t=O();t.site=e.site=="*"?2:e.site,t.fetchEvents(e.ids)}});function pt(e,t,d,s,p,u){const o=w("stats-figures"),a=w("stats-levels"),g=w("stats-support"),v=w("stats-completion");return i(),m(Y,null,[E(o),E(a),E(g),E(v)],64)}var ut=x(dt,[["render",pt]]);const ht=b({components:{"header-dashboard":pe,"stats-dashboard":ut}}),gt=async()=>{const e=K(ht);return e.use(G()),e.mount("#dashboard")};gt().then(e=>{});
//# sourceMappingURL=dashboard.0a68e7ac.js.map

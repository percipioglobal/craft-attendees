var we=Object.defineProperty;var be=Object.getOwnPropertySymbols;var ke=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable;var ge=(e,o,s)=>o in e?we(e,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[o]=s,de=(e,o)=>{for(var s in o||(o={}))ke.call(o,s)&&ge(e,s,o[s]);if(be)for(var s of be(o))xe.call(o,s)&&ge(e,s,o[s]);return e};import{d as Se,a as G,b as F,s as j,c as r,t as _,o as l,n as x,r as f,w as Q,e as g,f as t,g as w,h as Ce,i as ve,v as Ae,j as ue,k as ce,l as Fe,F as D,m as W,p as S,q as N,u as ie,x as pe,y as Ie,V as Ne,z as Te,A as qe,B as Ee}from"./vendor.f39e0bf1.js";var ye,$e;const re=($e=(ye=window==null?void 0:window.Attendee)==null?void 0:ye.cpUrl)!=null?$e:"https://researchschool.org.uk/cp",J=Se("trainings",{state:()=>({attendees:null,totalAttendees:null,attendeeInput:null,attendeeFormErrors:!1,attendeeSuccess:!1,showForm:!1,loading:!1,loadingApi:!1,schools:null,followOnSupportOptions:null}),actions:{fetchOptions(e){const o=this;this.loading=!0,G({method:"get",url:`${re}/craft-attendees/trainings/fetch-support-options/${e}`}).then(function(s){var a,i;o.loading=!1,o.followOnSupportOptions=(a=s.data)==null?void 0:a.options,o.followOnSupportSelectedOptions=(i=s.data)==null?void 0:i.selectedOptions})},saveOption(e){const o=this;this.loading=!0,G({method:"post",url:`${re}/actions/craft-attendees/training/save-support-options`,data:e}).then(function(s){o.loading=!1})},async fetchSchools(e){var o;if(e){this.loadingApi=!0;const a=await G.create({baseURL:`https://api.v2.metaseed.io/schools/?mode=legacy&query=${e}`,timeout:3e3}).get("");(a==null?void 0:a.data)?(this.schools=(o=a.data)==null?void 0:o.suggestions,this.loadingApi=!1):this.loadingApi=!1}},deleteAttendee(e){const o=this;this.loading=!0,G({method:"post",url:`${re}/actions/craft-attendees/training/delete`,data:e}).then(function(s){o.loading=!1,o.attendees=o.attendees.filter(a=>a.id!=e.attendeeId)})},submitAttendee(e){let o={};if(e instanceof FormData)for(var s of e.entries())o[s[0]]=s[1];else o=e;this.attendeeFormErrors=!1,this.loading=!0,this.attendeeSuccess=!1,this.attendeeInput=o;const a=this;G({method:"post",url:`${re}/actions/craft-attendees/training/save`,data:e}).then(function(i){var p;if(!i.data.success)a.attendeeFormErrors=i.data.errors,a.loading=!1,a.attendeeSuccess=!1;else{let d=a.attendees.filter(u=>{var h,v;return u.id==((v=(h=i==null?void 0:i.data)==null?void 0:h.attendee)==null?void 0:v.id)});const c=a.attendees.findIndex(u=>{var h,v;return u.id==((v=(h=i==null?void 0:i.data)==null?void 0:h.attendee)==null?void 0:v.id)});d.length>0?(d=d[0],d.name=o==null?void 0:o.name,d.orgName=o==null?void 0:o.orgName,d.orgUrn=o==null?void 0:o.orgUrn,d.postCode=o==null?void 0:o.postCode,d.days=o==null?void 0:o.days,d.email=o==null?void 0:o.email,d.newsletter=o==null?void 0:o.newsletter,d.approved=o==null?void 0:o.approved,d.jobRole=o==null?void 0:o.jobRole,a.attendees[c]=d):a.attendees.unshift((p=i==null?void 0:i.data)==null?void 0:p.attendee),a.loading=!1,a.attendeeFormErrors=!1,a.attendeeSuccess=!0,a.attendeeInput=null}})},fetchAttendees(e,o,s){const a=this;this.loading=!0,G({method:"get",url:`${re}/craft-attendees/trainings/attendees/${e}/${o}/${s}`}).then(function(i){var p,d,c,u;a.loading=!1,a.totalAttendees=parseInt((d=(p=i==null?void 0:i.data)==null?void 0:p.meta)==null?void 0:d.total),a.attendees=s!==0?a.attendees.concat((c=i==null?void 0:i.data)==null?void 0:c.attendees):(u=i==null?void 0:i.data)==null?void 0:u.attendees})},setShowFrom(e){this.attendeeFormErrors=!1,this.showForm=e},resetForm(){this.loading=!1,this.attendeeFormErrors=!1,this.attendeeInput=null},clearSchools(){this.schools=null}}});var T=(e,o)=>{const s=e.__vccOpts||e;for(const[a,i]of o)s[a]=i;return s};const Re=F({setup(){const e=J(),{showForm:o}=j(e);return{showForm:o,toggle:()=>{e.setShowFrom(!0)}}}});function Ve(e,o,s,a,i,p){return l(),r("button",{class:"bg-emerald-300 text-emerald-800 font-bold py-2 px-3 text-sm rounded-lg cursor-pointer",onClick:o[0]||(o[0]=(...d)=>e.toggle&&e.toggle(...d))},_(e.showForm?"Close form":"Add attendee"),1)}var De=T(Re,[["render",Ve]]);const Pe=F({props:{show:{type:Boolean,default:!1}}});function ze(e,o,s,a,i,p){return l(),r("div",{class:x(["fixed left-1/2 top-0 z-[100] bg-emerald-400 text-emerald-800 px-8 py-2 rounded-bl-lg rounded-br-lg font-bold transition-all duration-500",e.show?"opacity-100":"opacity-0 pointer-events-none"])},"Saved succesfully",2)}var Ue=T(Pe,[["render",ze]]);const Be=F({props:{approved:{type:Number},urn:{type:String,default:""},disabled:{type:Boolean,default:!1}},setup(e){const o=f(0),s=f(e.urn);return Q(()=>{s.value=e.urn,e.urn||(s.value=""),e.disabled?o.value=0:e.approved==1&&s.value.length>0?o.value=1:e.approved==0&&s.value.length>0?o.value=2:e.approved==1&&s.value.length==0?o.value=3:e.approved==0&&s.value.length==0?o.value=4:o.value=0}),{status:o,urnVal:s}}}),He={class:"absolute right-0 top-8 text-xs text-gray-600"},Oe={key:0,class:"flex items-center"},Me=t("span",{class:"inline-block w-3 h-3 bg-gray-400 rounded-full"},null,-1),Le=t("span",null,"Use the fields below to add attendee data. All data must be verified to count towards reporting metrics.",-1),Ke=[Me,Le],je={key:1,class:"flex items-center"},Je=t("span",{class:"inline-block w-3 h-3 bg-emerald-400 rounded-full"},null,-1),Ye=w("School verified and linked to "),Ge=["href"],Qe={key:2,class:"flex items-center"},We=t("span",{class:"inline-block w-3 h-3 bg-orange-400 rounded-full"},null,-1),Xe=w("School pending verification. Linked to "),Ze=["href"],et={key:3,class:"flex items-center"},tt=t("span",{class:"inline-block w-3 h-3 border-2 border-solid border-emerald-400 bg-emerald-100 rounded-full"},null,-1),ot=t("span",null,"Organisation verified. Not linked to government establishment data",-1),st=[tt,ot],nt={key:4,class:"flex items-center"},lt=t("span",{class:"inline-block w-3 h-3 border-2 border-solid border-orange-400 bg-orange-100 rounded-full"},null,-1),at=t("span",null,"Organisation pending verification. Not linked to government establishment data.",-1),rt=[lt,at];function dt(e,o,s,a,i,p){return l(),r("div",He,[e.status===0?(l(),r("p",Oe,Ke)):g("",!0),e.status===1?(l(),r("p",je,[Je,t("span",null,[Ye,t("a",{href:`https://get-information-schools.service.gov.uk/Establishments/Establishment/Details/${e.urnVal}`,class:"underline text-gray-600",target:"_blank"},"government establishment data",8,Ge)])])):g("",!0),e.status===2?(l(),r("p",Qe,[We,t("span",null,[Xe,t("a",{href:`https://get-information-schools.service.gov.uk/Establishments/Establishment/Details/${e.urnVal}`,class:"underline text-gray-600",target:"_blank"},"government establishment data",8,Ze)])])):g("",!0),e.status===3?(l(),r("p",et,st)):g("",!0),e.status===4?(l(),r("p",nt,rt)):g("",!0)])}var me=T(Be,[["render",dt]]);const it=F({props:{label:{type:String,required:!1},name:{type:String,required:!0},label:{type:String,default:""},checked:{default:0}},setup(e,{emit:o}){const s=f(0);return Q(()=>{s.value=e.checked==0?0:1}),{toggle:()=>{s.value=s.value==0?1:0,o("changed",s.value)},checkedValue:s}}}),ut={class:"inline-block relative flex items-center cursor-pointer"},ct=["name","value","checked"],pt={class:"peer-focus:ring-2 peer-focus:ring-opacity-50 peer-focus:ring-blue-700 peer-focus:shadow-lg outline-none rounded-full inline-block cursor-pointer"},ht={key:0,class:"inline-flex pl-2"};function ft(e,o,s,a,i,p){return l(),r("label",ut,[t("input",{name:e.name,type:"checkbox",class:"peer sr-only",onClick:o[0]||(o[0]=(...d)=>e.toggle&&e.toggle(...d)),value:e.checkedValue,checked:e.checkedValue==1},null,8,ct),t("div",pt,[t("div",{class:x(["block h-6 rounded-full w-10 cursor-pointer bg-opacity-100",e.checkedValue==1?"bg-emerald-100":"bg-indigo-100"])},null,2),t("div",{class:x(["absolute w-4 h-4 transition rounded-full left-1 top-1 flex items-center not-sr-only",e.checkedValue==1?"bg-emerald-700 transform translate-x-full":"bg-gray-400"])},null,2)]),e.label.length>0?(l(),r("span",ht,_(e.label),1)):g("",!0)])}var _e=T(it,[["render",ft]]);const bt=F({props:{values:{type:Object,default:{}}},emits:["schoolSelect","schoolInput"],setup(e,{emit:o}){var R,V,k,A,Y,L,X,Z,ee,te,oe,se;const s=f(null),a=J(),i=f(Math.floor(Math.random()*100)+Date.now()),{attendeeInput:p,attendeeFormErrors:d,schools:c,loadingApi:u}=j(a),h=f((A=(k=(R=p.value)==null?void 0:R.orgName)!=null?k:(V=e.values)==null?void 0:V.orgName)!=null?A:""),v=f((Z=(X=(Y=p.value)==null?void 0:Y.orgUrn)!=null?X:(L=e.values)==null?void 0:L.orgUrn)!=null?Z:""),b=f((se=(oe=(ee=p.value)==null?void 0:ee.postCode)!=null?oe:(te=e.values)==null?void 0:te.postCode)!=null?se:""),n=f(null),I=f(!1),$=f(0),C=f(!0),y=m=>{var q,K,ne,le,ae,fe;h.value=(K=(q=m.currentTarget)==null?void 0:q.dataset)==null?void 0:K.name,v.value=(le=(ne=m.currentTarget)==null?void 0:ne.dataset)==null?void 0:le.urn,b.value=(fe=(ae=m.currentTarget)==null?void 0:ae.dataset)==null?void 0:fe.postcode,C.value=!1,o("schoolSelect",h.value,v.value,b.value),I.value=!1,a.clearSchools()},P=()=>{C.value=!0,h.value.length>2&&(I.value=!0,a.fetchSchools(h.value))},O=m=>{var q;((q=h.value)==null?void 0:q.length)===0&&a.clearSchools(),I.value=m},M=()=>{n.value&&clearTimeout(n.value),n.value=setTimeout(P,200)},z=()=>{var m,q;$.value=$.value<((m=c.value)==null?void 0:m.length)-1?$.value+1:((q=c.value)==null?void 0:q.length)-1,s.value.querySelectorAll("li")[$.value].scrollIntoView({block:"nearest"})},U=()=>{$.value=$.value>0?$.value-1:0,s.value.querySelectorAll("li")[$.value].scrollIntoView({block:"nearest"})},B=()=>{var q,K,ne,le,ae;const m={currentTarget:{dataset:{name:(q=c.value[$.value])==null?void 0:q.value,urn:(ne=(K=c.value[$.value])==null?void 0:K.data)==null?void 0:ne.urn,postcode:(ae=(le=c.value[$.value])==null?void 0:le.data)==null?void 0:ae.postcode}}};y(m)},H=()=>{var m;h.value=null,((m=v.value)==null?void 0:m.length)>0&&E()};Ce(h,(m,q)=>{var K;m!==q&&((K=v.value)==null?void 0:K.length)>0&&C.value&&E(),o("schoolInput",m||""),C.value=!0});const E=()=>{v.value=null,b.value=null,o("schoolSelect",h.value,v.value,b.value),I.value=!1,a.clearSchools()};return{attendeeInput:p,attendeeFormErrors:d,school:h,schools:c,urn:v,uniqueId:i,postcode:b,showDropdown:I,schoolDropdown:s,currentSelectionIndex:$,clearResults:C,loadingApi:u,delay:M,handleSchoolSelect:y,handleSchoolInput:P,handleFocus:O,handleClear:H,onArrowDown:z,onArrowUp:U,selectCurrentSelection:B}}}),gt=["value"],vt={class:"block mb-6"},mt=t("span",{class:"text-xs font-bold text-gray-400 block mb-1"},[w("School / Organisation "),t("span",{class:"text-blue-500"},"*")],-1),_t={class:"w-full relative"},yt=["aria-owns"],$t=["aria-expanded","id"],wt=["data-postcode","data-urn","data-name"],kt={class:"block w-full text-sm font-medium"},xt={key:1,class:"p-2 block"},St={key:1,class:"p-2 pt-3 inline-block"},Ct=t("svg",{class:"animate-spin mr-1 h-4 w-4 text-gray-800",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),At=[Ct],Ft={class:"block mb-6"},It=t("span",{class:"text-xs font-bold text-gray-400 block mb-1"},"Post code",-1),Nt=["value","readonly"];function Tt(e,o,s,a,i,p){var d,c,u,h,v,b;return l(),r(D,null,[t("input",{type:"hidden",name:"orgUrn",value:(d=e.urn)!=null?d:""},null,8,gt),t("label",vt,[mt,t("div",_t,[ve(t("input",{name:"orgName","onUpdate:modelValue":o[0]||(o[0]=n=>e.school=n),onInput:o[1]||(o[1]=(...n)=>e.delay&&e.delay(...n)),onFocus:o[2]||(o[2]=n=>e.handleFocus(!0)),onBlur:o[3]||(o[3]=n=>e.handleFocus(!1)),onKeydown:[o[4]||(o[4]=ue(ce((...n)=>e.onArrowDown&&e.onArrowDown(...n),["prevent"]),["down"])),o[5]||(o[5]=ue(ce((...n)=>e.onArrowUp&&e.onArrowUp(...n),["prevent"]),["up"])),o[6]||(o[6]=ue(ce((...n)=>e.selectCurrentSelection&&e.selectCurrentSelection(...n),["prevent"]),["enter"]))],class:x(["block peer w-full px-2 py-2 text-sm text-gray-600 box-border bg-gray-100 rounded-lg pr-7",((c=e.attendeeFormErrors)==null?void 0:c.orgName)?"border-solid border-red-300":"border-solid border-gray-100"]),placeholder:"Search for a school or organisation","aria-owns":`metaseed-list-${e.uniqueId}`,"aria-autocomplete":"list",role:"combobox"},null,42,yt),[[Ae,e.school]]),((u=e.school)==null?void 0:u.length)>3?(l(),r("span",{key:0,onClick:o[7]||(o[7]=(...n)=>e.handleClear&&e.handleClear(...n)),class:"text-blue-800 bg-gray-100 block w-6 text-center flex items-center justify-center h-8 absolute right-0 top-1 cursor:pointer"},"\u2715")):g("",!0),ve(t("ul",{class:"absolute left-0 top-full mt-1 w-128 max-h-52 overflow-scroll z-10 bg-gray-100 rounded-lg shadow-xl",ref:"schoolDropdown","aria-expanded":e.showDropdown,role:"listbox",id:`metaseed-list-${e.uniqueId}`},[e.loadingApi?g("",!0):(l(!0),r(D,{key:0},W(e.schools,(n,I)=>{var $,C,y,P,O,M,z,U,B,H,E,R,V,k;return l(),r("li",{key:($=n==null?void 0:n.data)==null?void 0:$.urn,role:"option"},[(n==null?void 0:n.data)?(l(),r("span",{key:0,onMousedown:o[8]||(o[8]=(...A)=>e.handleSchoolSelect&&e.handleSchoolSelect(...A)),onTouch:o[9]||(o[9]=(...A)=>e.handleSchoolSelect&&e.handleSchoolSelect(...A)),role:"button","data-postcode":(C=n==null?void 0:n.data)==null?void 0:C.postcode,"data-urn":(y=n==null?void 0:n.data)==null?void 0:y.urn,"data-name":n==null?void 0:n.value,class:x(["p-2 pointer-all hover:bg-blue-600 hover:text-white focus:bg-blue-600 block group",e.currentSelectionIndex===I?"bg-blue-600 text-white":""])},[t("span",kt,_(n.value),1),t("span",{class:x(["block text-xs group-hover:text-white",e.currentSelectionIndex===I?"text-white":"text-gray-500"])},"[URN: "+_((O=(P=n==null?void 0:n.data)==null?void 0:P.urn)!=null?O:"-")+"] "+_((z=(M=n==null?void 0:n.data)==null?void 0:M.street)!=null?z:"-")+", "+_((B=(U=n==null?void 0:n.data)==null?void 0:U.town)!=null?B:"-")+" "+_((H=n==null?void 0:n.data)==null?void 0:H.postcode)+" (Age "+_((R=(E=n==null?void 0:n.data)==null?void 0:E.ageFrom)!=null?R:"/")+" - "+_((k=(V=n==null?void 0:n.data)==null?void 0:V.ageTo)!=null?k:"/")+")",3)],42,wt)):(l(),r("span",xt," There's no school that matches the input "))])}),128)),e.loadingApi?(l(),r("li",St,At)):g("",!0)],8,$t),[[Fe,e.showDropdown]])])]),t("label",Ft,[It,t("input",{name:"postCode",value:e.postcode,readonly:((h=e.urn)==null?void 0:h.length)>0,class:x(["block w-full px-2 py-2 text-sm text-gray-600 appearance-none box-border bg-gray-100 rounded-lg",((v=e.urn)==null?void 0:v.length)>0?"text-gray-400 cursor-not-allowed":"",((b=e.attendeeFormErrors)==null?void 0:b.postCode)?"border-solid border-red-300":"border-solid border-gray-100"]),placeholder:"Enter a post code"},null,10,Nt)])],64)}var qt=T(bt,[["render",Tt]]);const Et=F({components:{"input-school":qt,"input-switch":_e,"status-approved":me},emits:["hideForm","saveAnother","submitForm"],props:{csrf:{type:String,required:!0},event:{type:String,required:!0},title:{type:String},values:{type:Object,default:{}},hideAnother:{type:Boolean,default:!1}},setup(e,{emit:o}){var z,U,B,H,E,R,V;const s=f(null);f(null),f(null);const a=f((U=(z=e.values)==null?void 0:z.urn)!=null?U:null),i=f(!1),p=f((E=(B=e.attendeeInput)==null?void 0:B.approved)!=null?E:((H=a.value)==null?void 0:H.length)>0?1:0),d=f((V=(R=e.values)==null?void 0:R.orgName)!=null?V:""),c=J(),{attendeeInput:u,attendeeFormErrors:h,loading:v,showForm:b,resetAttendeeInput:n}=j(c),I=k=>{if(k.preventDefault(),o("saveAnother",i.value),s.value){let A=new FormData(s.value);c.submitAttendee(A),o("submitForm")}},$=k=>{i.value=k.currentTarget.dataset.saveanother},C=()=>{c.resetForm(),o("hideForm")},y=k=>{k.keyCode===27&&C()},P=(k,A,Y)=>{var L;a.value=A,p.value=((L=a.value)==null?void 0:L.length)>0?1:0},O=k=>{d.value=k},M=()=>{p.value=p.value==1?0:1};return Q(()=>{var k,A;(k=s.value)==null||k.querySelectorAll('input[name="orgName"]')[0].focus(),b.value&&((A=s.value)==null||A.querySelectorAll('input[name="orgName"]')[0].focus())}),{form:s,attendeeInput:u,attendeeFormErrors:h,loading:v,showForm:b,urn:a,approved:p,school:d,handleSubmitButton:$,handleSubmit:I,hideForm:C,keyup:y,handleSchoolInput:O,handleSchoolSelect:P,handleSchoolVerifyChange:M}}}),Rt=t("input",{type:"hidden",name:"action",value:"actions/craft-attendees/training/save"},null,-1),Vt=["value"],Dt=["value"],Pt=["value"],zt={class:"grid grid-cols-3 gap-x-4"},Ut={class:"block mb-6"},Bt=t("span",{class:"text-xs font-bold text-gray-400 block mb-1"},"School is verified",-1),Ht={class:"grid grid-cols-3 gap-x-4"},Ot={class:"block mb-6"},Mt=t("span",{class:"text-xs font-bold text-gray-400 block mb-1"},[w("Name of attendee "),t("span",{class:"text-blue-500"},"*")],-1),Lt=["value"],Kt={class:"block mb-6"},jt=t("span",{class:"text-xs font-bold text-gray-400 block mb-1"},[w("Email address of attendee "),t("span",{class:"text-blue-500"},"*")],-1),Jt=["value"],Yt={class:"block mb-6"},Gt=t("span",{class:"text-xs font-bold text-gray-400 block mb-1"},"Subscribe for the newsletter",-1),Qt={class:"grid grid-cols-3 gap-x-4"},Wt={class:"block mb-6"},Xt=t("span",{class:"text-xs font-bold text-gray-400 block mb-1"},[w("Attendee's job role "),t("span",{class:"text-blue-500"},"*")],-1),Zt=["value"],eo=ie('<option value="" default disabled class="text-gray-400">Select the job role of the attendee</option><option value="na">Not Applicable</option><option value="support">Support Staff</option><option value="leader-middle">Middle leader</option><option value="leader">Leadership</option><option value="teacher">Teacher</option>',6),to=[eo],oo={class:"block mb-6"},so=t("span",{class:"text-xs font-bold text-gray-400 block mb-1"},[w("Attending days "),t("span",{class:"text-blue-500"},"*")],-1),no=["value"],lo=ie('<option default value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option>',10),ao=[lo],ro={class:"text-right"},io={key:0,class:"animate-spin -ml-1 mr-1 h-3 w-3 text-emerald-800",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},uo=t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),co=t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),po=[uo,co],ho=w(" Save and add another "),fo={key:0,class:"animate-spin -ml-1 mr-1 h-3 w-3 text-emerald-800",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},bo=t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),go=t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),vo=[bo,go],mo=w(" Save ");function _o(e,o,s,a,i,p){var h,v,b,n,I,$,C,y,P,O,M,z,U,B,H,E,R,V,k,A,Y,L,X,Z,ee,te,oe,se;const d=S("status-approved"),c=S("input-school"),u=S("input-switch");return l(),r(D,null,[N(d,{approved:parseInt(e.approved),urn:e.urn,disabled:e.school.length===0},null,8,["approved","urn","disabled"]),t("form",{ref:"form",method:"post",action:"","accept-charset":"UTF-8",class:"mt-8",onKeyup:o[3]||(o[3]=(...m)=>e.keyup&&e.keyup(...m)),onSubmit:o[4]||(o[4]=(...m)=>e.handleSubmit&&e.handleSubmit(...m))},[Rt,t("input",{type:"hidden",name:"event",value:e.event},null,8,Vt),t("input",{type:"hidden",name:"CRAFT_CSRF_TOKEN",value:e.csrf},null,8,Dt),t("input",{type:"hidden",name:"attendeeId",value:(n=(b=(h=e.attendeeInput)==null?void 0:h.id)!=null?b:(v=e.values)==null?void 0:v.id)!=null?n:""},null,8,Pt),t("div",zt,[N(c,{values:e.values,onSchoolSelect:e.handleSchoolSelect,onSchoolInput:e.handleSchoolInput},null,8,["values","onSchoolSelect","onSchoolInput"]),t("label",Ut,[Bt,N(u,{name:"approved",checked:e.approved,onChanged:e.handleSchoolVerifyChange},null,8,["checked","onChanged"])])]),t("div",Ht,[t("label",Ot,[Mt,t("input",{name:"name",value:(y=(C=(I=e.attendeeInput)==null?void 0:I.name)!=null?C:($=e.values)==null?void 0:$.name)!=null?y:"",class:x(["block w-full px-2 py-2 text-sm text-gray-600 appearance-none box-border bg-gray-100 rounded-lg",((P=e.attendeeFormErrors)==null?void 0:P.name)?"border-solid border-red-300":"border-solid border-gray-100"]),placeholder:"Enter the name of the attendee"},null,10,Lt)]),t("label",Kt,[jt,t("input",{name:"email",value:(U=(z=(O=e.attendeeInput)==null?void 0:O.email)!=null?z:(M=e.values)==null?void 0:M.email)!=null?U:"",class:x(["block w-full px-2 py-2 text-sm text-gray-600 appearance-none box-border bg-gray-100 rounded-lg",((B=e.attendeeFormErrors)==null?void 0:B.email)?"border-solid border-red-300":"border-solid border-gray-100"]),placeholder:"Enter the email of the attendee"},null,10,Jt)]),t("label",Yt,[Gt,N(u,{name:"newsletter",checked:(V=(R=(H=e.attendeeInput)==null?void 0:H.newsletter)!=null?R:(E=e.values)==null?void 0:E.newsletter)!=null?V:0},null,8,["checked"])])]),t("div",Qt,[t("label",Wt,[Xt,t("select",{name:"jobRole",value:(L=(Y=(k=e.attendeeInput)==null?void 0:k.jobRole)!=null?Y:(A=e.values)==null?void 0:A.jobRole)!=null?L:"",class:x(["block h-10 px-1 rounded-md bg-gray-100 w-full",((X=e.attendeeFormErrors)==null?void 0:X.jobRole)?"border-solid border-red-300":"border-none"])},to,10,Zt)]),t("label",oo,[so,t("select",{name:"days",value:(oe=(te=(Z=e.attendeeInput)==null?void 0:Z.days)!=null?te:(ee=e.values)==null?void 0:ee.days)!=null?oe:1,class:x(["block h-10 px-1 rounded-md border-none w-40 bg-gray-100",((se=e.attendeeFormErrors)==null?void 0:se.days)?"border-solid border-red-300":""])},ao,10,no)])]),t("div",ro,[t("span",{role:"button",class:"inline-block bg-gray-300 text-gray-800 font-bold py-2 px-3 mr-2 text-sm rounded-lg cursor-pointer",onClick:o[0]||(o[0]=(...m)=>e.hideForm&&e.hideForm(...m))},"Cancel"),e.hideAnother?g("",!0):(l(),r("button",{key:0,class:"bg-emerald-300 text-emerald-800 font-bold py-2 px-3 text-sm rounded-lg cursor-pointer inline-block mr-2","data-saveanother":!0,onClick:o[1]||(o[1]=(...m)=>e.handleSubmitButton&&e.handleSubmitButton(...m))},[e.loading?(l(),r("svg",io,po)):g("",!0),ho])),t("button",{class:"bg-emerald-300 text-emerald-800 font-bold py-2 px-3 text-sm rounded-lg cursor-pointer inline-block","data-saveanother":!1,onClick:o[2]||(o[2]=(...m)=>e.handleSubmitButton&&e.handleSubmitButton(...m))},[e.loading?(l(),r("svg",fo,vo)):g("",!0),mo])])],544)],64)}var he=T(Et,[["render",_o]]);const yo=F({components:{"form-attendee":he},props:{csrf:{type:String,required:!0},attendee:{type:Object,required:!0},show:{type:Boolean,required:!0}},setup(e,{emit:o}){const s=J(),{showForm:a,attendeeSuccess:i}=j(s);return{showForm:a,handleCancel:()=>{o("hidePopup")},handleDelete:()=>{let c={};c.CRAFT_CSRF_TOKEN=e.csrf,c.action="actions/craft-attendees/training/delete",c.attendeeId=e.attendee.id,s.deleteAttendee(c),o("hidePopup")}}}}),$o={class:"max-h-screen text-center overflow-auto fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-80"},wo={class:"bg-white p-6 rounded-xl mb-10"},ko=t("h3",{class:"text-lg"},"Delete this attendee",-1),xo={class:"flex justify-center"};function So(e,o,s,a,i,p){return l(),r("div",{class:x(["transition-all duration-500 delay-50 ease-in-out fixed left-0 top-0 w-screen h-screen",e.show?"z-[100] opacity-100 bg-gray-900 bg-opacity-50":"z-0 opacity-0 pointer-events-none"])},[t("div",$o,[t("div",wo,[ko,t("div",xo,[t("button",{onClick:o[0]||(o[0]=(...d)=>e.handleCancel&&e.handleCancel(...d)),class:"block bg-gray-300 text-gray-800 font-bold mt-2 py-2 px-3 text-sm rounded-lg cursor-pointer"}," Cancel "),t("button",{onClick:o[1]||(o[1]=(...d)=>e.handleDelete&&e.handleDelete(...d)),class:"block bg-red-300 text-red-800 font-bold mt-2 py-2 px-3 text-sm rounded-lg cursor-pointer"}," Yes, delete this attendee ")])])])],2)}var Co=T(yo,[["render",So]]);const Ao=F({components:{"form-attendee":he,"popup-delete-attendee":Co,"status-approved":me},props:{attendee:{type:Object,required:!0},csrf:{type:String,required:!0},event:{type:String,required:!0}},setup(e){const o=f(!1),s=f(!1),a=J(),{attendeeSuccess:i,loading:p}=j(a),d=f(!1),c=f(!1),u=f({na:"Not Applicable",support:"Support","leader-middle":"Middle leader",leader:"Leadership",teacher:"Teacher"}),h=()=>{o.value=!o.value},v=()=>{s.value=!s.value},b=()=>{c.value=!1},n=()=>{c.value=!0},I=()=>{d.value=!0},$=()=>{let y=de({},e.attendee);y.approved=1,y.CRAFT_CSRF_TOKEN=e.csrf,y.event=e.event,y.attendeeId=e.attendee.id,y.action="actions/craft-attendees/training/save",a.submitAttendee(y)},C=()=>{let y=de({},e.attendee);y.approved=0,y.CRAFT_CSRF_TOKEN=e.csrf,y.event=e.event,y.attendeeId=e.attendee.id,y.action="actions/craft-attendees/training/save",a.submitAttendee(y)};return Q(()=>{d.value&&i.value&&(s.value=!1,d.value=!1)}),{expanded:o,edit:s,loading:p,showDeletePopup:c,jobRoles:u,toggle:h,handleEdit:v,submitEdit:I,handleApprove:$,handleDisapprove:C,handleDelete:n,handleHidePopup:b}}}),Fo={class:"grid grid-cols-9 xl:grid-cols-11 w-full items-center"},Io={class:"col-span-3 p-3 flex flex-nowrap items-center font-bold cursor-pointer"},No=t("span",{class:"inline-flex mb-0"},[t("input",{type:"checkbox"})],-1),To={class:"w-full whitespace-nowrap text-ellipsis overflow-hidden"},qo={key:0,class:"block w-4 h-4 xl:inline-block xl:w-auto xl:h-auto rounded-full text-xs bg-orange-300 text-orange-800 text-bold xl:px-4 xl:py-1"},Eo=t("span",{class:"opacity-0 pointer-events-none xl:opacity-100"},"Unverified",-1),Ro=[Eo],Vo={key:1,class:"block w-4 h-4 xl:inline-block xl:w-auto xl:h-auto rounded-full text-xs bg-emerald-400 text-white text-bold xl:px-4 xl:py-1"},Do=t("span",{class:"opacity-0 pointer-events-none xl:opacity-100"},"Verified",-1),Po=[Do],zo={class:"text-right pr-8 box-border"},Uo=["href"],Bo={key:1,class:"pr-1"},Ho={key:0,class:"px-10 py-6 relative"},Oo={class:"pt-6 relative"},Mo=t("h3",{class:"text-lg"},"Attendee details",-1),Lo={key:1,class:"absolute left-0 top-0 bg-white bg-opacity-50 z-10 w-full h-full"},Ko=t("div",{class:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2"},[t("svg",{class:"animate-spin -ml-1 mr-1 mt-1 h-10 w-10 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})])],-1),jo=[Ko],Jo={key:2,class:"w-full pt-5"},Yo={class:"grid grid-cols-3 gap-x-4"},Go={class:"mb-6"},Qo=t("span",{class:"text-xs font-bold text-gray-400 block"},"School / Organisation",-1),Wo={class:"text-base mt-1 block"},Xo={class:"mb-6"},Zo=t("span",{class:"text-xs font-bold text-gray-400 block"},"School or organisation post code",-1),es={class:"text-base mt-1 block"},ts={class:"mb-6"},os=t("span",{class:"text-xs font-bold text-gray-400 block mb-2"},"Verified status",-1),ss={key:0,class:"inline-block rounded-full text-xs bg-orange-300 text-orange-800 text-bold px-4 py-1"},ns={key:1,class:"inline-block rounded-full text-xs bg-emerald-400 text-white text-bold px-4 py-1"},ls={class:"grid grid-cols-3 gap-x-4"},as={class:"mb-6"},rs=t("span",{class:"text-xs font-bold text-gray-400 block"},"Name of the attendee",-1),ds={class:"text-base mt-1 block"},is={class:"mb-6"},us=t("span",{class:"text-xs font-bold text-gray-400 block"},"Email address of attendee",-1),cs={class:"text-base mt-1 block"},ps={class:"mb-6"},hs=t("span",{class:"text-xs font-bold text-gray-400 block"},"Subscribed for the newsletter?",-1),fs={class:"text-base mt-1 block"},bs={class:"grid grid-cols-3 gap-x-4"},gs={class:"mb-6"},vs=t("span",{class:"text-xs font-bold text-gray-400 block"},"Attendee's job role",-1),ms={class:"text-base mt-1 block"},_s={class:"mb-6"},ys=t("span",{class:"text-xs font-bold text-gray-400 block"},"Days attended",-1),$s={class:"text-base mt-1 block"},ws={class:"text-right"};function ks(e,o,s,a,i,p){var h,v,b;const d=S("status-approved"),c=S("form-attendee"),u=S("popup-delete-attendee");return l(),r("div",{tabindex:"0",class:x(["w-full border-l-2 border-solid",e.expanded?"bg-blue-100 bg-opacity-10":"border-white",((h=e.attendee)==null?void 0:h.approved)&&e.expanded?"border-emerald-300":"",(e.attendee.approved==0||!e.attendee.approved)&&e.expanded?"border-orange-300":""])},[t("div",Fo,[t("div",Io,[No,t("span",{class:"inline-flex pl-2 flex-grow",onClick:o[0]||(o[0]=(...n)=>e.toggle&&e.toggle(...n))},_(e.attendee.orgName),1)]),t("div",{class:"col-span-2 box-border p-3 cursor-pointer flex items-center",onClick:o[1]||(o[1]=(...n)=>e.toggle&&e.toggle(...n))},_(e.attendee.name),1),t("div",{class:"col-span-1 xl:col-span-3 box-border p-3 cursor-pointer flex items-center",onClick:o[2]||(o[2]=(...n)=>e.toggle&&e.toggle(...n))},[t("span",To,_(e.attendee.email),1)]),t("div",{class:"box-border p-3 cursor-pointer flex items-center",onClick:o[3]||(o[3]=(...n)=>e.toggle&&e.toggle(...n))},_(e.attendee.days),1),t("div",{class:"box-border p-3 cursor-pointer",onClick:o[4]||(o[4]=(...n)=>e.toggle&&e.toggle(...n))},[e.attendee.approved==0||!e.attendee.approved?(l(),r("span",qo,Ro)):(l(),r("span",Vo,Po))]),t("div",zo,[e.attendee.orgUrn?(l(),r("a",{key:0,href:`https://get-information-schools.service.gov.uk/Establishments/Establishment/Details/${(v=e.attendee)==null?void 0:v.orgUrn}`,target:"_blank",class:"text-blue-800 text-xl"}," \u2197 ",8,Uo)):(l(),r("span",Bo,"-"))])]),e.expanded?(l(),r("div",Ho,[t("div",Oo,[Mo,e.edit?g("",!0):(l(),pe(d,{key:0,approved:parseInt(e.attendee.approved),urn:e.attendee.orgUrn},null,8,["approved","urn"])),e.loading?(l(),r("div",Lo,jo)):g("",!0),e.edit?g("",!0):(l(),r("div",Jo,[t("div",Yo,[t("div",Go,[Qo,t("span",Wo,_(e.attendee.orgName),1)]),t("div",Xo,[Zo,t("span",es,_(e.attendee.postCode),1)]),t("div",ts,[os,e.attendee.approved==0||!e.attendee.approved?(l(),r("span",ss,"Unverified")):(l(),r("span",ns,"Verified"))])]),t("div",ls,[t("div",as,[rs,t("span",ds,_(e.attendee.name),1)]),t("div",is,[us,t("span",cs,_(e.attendee.email),1)]),t("div",ps,[hs,t("span",fs,_(e.attendee.newsletter==1?"Yes":"No"),1)])]),t("div",bs,[t("div",gs,[vs,t("span",ms,_((b=e.jobRoles[e.attendee.jobRole])!=null?b:"-"),1)]),t("div",_s,[ys,t("span",$s,_(e.attendee.days),1)])]),t("div",ws,[t("button",{onClick:o[5]||(o[5]=(...n)=>e.handleDelete&&e.handleDelete(...n)),class:"inline-block bg-red-300 text-red-800 font-bold mr-2 py-2 px-3 text-sm rounded-lg cursor-pointer"}," Delete "),e.attendee.approved==0||!e.attendee.approved?(l(),r("button",{key:0,onClick:o[6]||(o[6]=(...n)=>e.handleApprove&&e.handleApprove(...n)),class:"inline-block bg-emerald-300 text-emerald-800 font-bold mr-2 py-2 px-3 text-sm rounded-lg cursor-pointer"}," Verify ")):(l(),r("button",{key:1,onClick:o[7]||(o[7]=(...n)=>e.handleDisapprove&&e.handleDisapprove(...n)),class:"inline-block bg-orange-300 text-orange-800 font-bold py-2 px-3 text-sm rounded-lg cursor-pointer mr-2"}," Unverify ")),t("button",{onClick:o[8]||(o[8]=(...n)=>e.handleEdit&&e.handleEdit(...n)),class:"inline-block bg-gray-300 text-gray-800 py-2 px-3 text-sm font-bold rounded-lg cursor-pointer"},"Edit")])])),e.edit?(l(),pe(c,{key:3,csrf:e.csrf,values:e.attendee,event:e.event,onHideForm:e.handleEdit,onSubmitForm:e.submitEdit,hideAnother:!0},null,8,["csrf","values","event","onHideForm","onSubmitForm"])):g("",!0),N(u,{show:e.showDeletePopup,csrf:e.csrf,attendee:e.attendee,onHidePopup:e.handleHidePopup},null,8,["show","csrf","attendee","onHidePopup"])])])):g("",!0)],2)}var xs=T(Ao,[["render",ks]]);const Ss=F({components:{"list-item-attendee":xs,"status-saved":Ue},props:{event:{type:String,required:!0},csrf:{type:String,required:!0}},setup(e){const o=J(),{attendees:s,loading:a,totalAttendees:i,attendeeSuccess:p}=j(o),d=f(30),c=f(0),u=f(0),h=f(!1),v=()=>{c.value=c.value+d.value,o.fetchAttendees(e.event,d.value,c.value)};return Q(()=>{u.value=i.value-c.value-d.value,p.value&&(h.value=!0,setTimeout(()=>{h.value=!1},3e3))}),o.fetchAttendees(e.event,d.value,c.value),{showSuccess:h,attendees:s,loading:a,offset:c,totalAttendees:i,remainingEntries:u,handleLoadMore:v}}}),Cs=t("div",{class:"grid grid-cols-9 xl:grid-cols-11 bg-gray-100 py-2 items-center"},[t("div",{class:"col-span-3 p-3 text-left text-xs font-semibold text-gray-600 uppercase flex flex-nowrap items-center"},[t("span",{class:"inline-flex mb-0"},[t("input",{type:"checkbox",indeterminate:"true"})]),t("span",{class:"inline-flex pl-2"},"School / Organisation")]),t("div",{class:"col-span-2 p-3 text-left text-xs font-semibold text-gray-600 uppercase"}," Name of attendee "),t("div",{class:"col-span-1 xl:col-span-3 p-3 text-left text-xs font-semibold text-gray-600 uppercase"}," Email "),t("div",{class:"p-3 text-left text-xs font-semibold text-gray-600 uppercase"}," Days "),t("div",{class:"p-3 text-left text-xs font-semibold text-gray-600 uppercase"}," Status "),t("div",{class:"p-3 text-right pr-8 text-lg font-semibold text-gray-600 uppercase"},"\u2197")],-1),As={class:"rounded-xl bg-white overflow-hidden min-h-16"},Fs={key:0,class:"w-full pt-2"},Is={key:1,class:"animate-spin ml-4 mt-5 mb-3 h-6 w-6 text-gray-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ns=t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),Ts=t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),qs=[Ns,Ts],Es={key:2,class:"p-6"},Rs={class:"ml-4 mt-4 relative text-center"},Vs={class:"inline-block text-gray-500 absolute left-0 top-1/2 -translate-y-1/2"};function Ds(e,o,s,a,i,p){var u;const d=S("status-saved"),c=S("list-item-attendee");return l(),r(D,null,[N(d,{show:e.showSuccess},null,8,["show"]),Cs,t("div",As,[e.attendees&&e.attendees.length>0?(l(),r("div",Fs,[(l(!0),r(D,null,W(e.attendees,(h,v)=>(l(),r("article",{class:x([e.attendees.length-1!==v?"border-b border-gray-100 border-solid":""])},[N(c,{event:e.event,csrf:e.csrf,attendee:h},null,8,["event","csrf","attendee"])],2))),256))])):g("",!0),e.loading?(l(),r("svg",Is,qs)):g("",!0),(!e.attendees||e.attendees.length===0)&&!e.loading?(l(),r("p",Es,"There are currently no attendees for this event")):g("",!0)]),t("div",Rs,[t("span",Vs,"Total results: "+_(!e.attendees||e.attendees.length>0?(u=e.attendees)==null?void 0:u.length:"0"),1),t("button",{class:x(["bg-gray-300 text-gray-800 font-bold py-2 px-3 text-sm rounded-lg cursor-pointer",e.remainingEntries>0?"":"opacity-0 pointer-events-none"]),onClick:o[0]||(o[0]=(...h)=>e.handleLoadMore&&e.handleLoadMore(...h))},"Load more ("+_(e.remainingEntries)+")",3)])],64)}var Ps=T(Ss,[["render",Ds]]);const zs=F({components:{"input-switch":_e},props:{event:{type:String,required:!0},csrf:{type:String,required:!0}},setup(e){const o=J(),{followOnSupportOptions:s,followOnSupportSelectedOptions:a,loading:i}=j(o),p=c=>{let u={};u.value=c,u.CRAFT_CSRF_TOKEN=e.csrf,u.event=e.event,u.action="actions/craft-attendees/training/saveOption",o.saveOption(u)},d=c=>o.followOnSupportSelectedOptions.filter(h=>h.optionId==c.id).length>0?1:0;return o.fetchOptions(e.event),{followOnSupportOptions:s,followOnSupportSelectedOptions:a,loading:i,handleChange:p,getChecked:d}}}),Us={class:"bg-white w-full p-6 rounded-xl box-border"},Bs={class:"block flex items-center"},Hs={key:0,class:"bg-gray-200 bg-opacity-50 absolute left-0 top-0 w-full h-full"},Os=ie('<div class="absolute left-1/2 top-1/2 -translate-y-1/2 -translate-x-1/2"><svg class="animate-spin h-10 w-10 text-gray-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></div><div class="block bg-gray-200 bg-opacity-50 w-6 left-full pb-6 top-0 h-full absolute z-10"></div><div class="block bg-gray-200 bg-opacity-50 h-6 top-full left-0 w-full absolute z-10"></div>',3),Ms=[Os];function Ls(e,o,s,a,i,p){const d=S("input-switch");return l(),r(D,null,[t("div",Us,[(l(!0),r(D,null,W(e.followOnSupportOptions,c=>(l(),r("div",Bs,[N(d,{name:"option",checked:e.getChecked(c),label:c.name,value:c.value,onChanged:u=>e.handleChange(c.value)},null,8,["checked","label","value","onChanged"])]))),256))]),e.loading?(l(),r("div",Hs,Ms)):g("",!0)],64)}var Ks=T(zs,[["render",Ls]]);const js=F({components:{"form-attendee":he},props:{csrf:{type:String,required:!0},event:{type:String,required:!0}},setup(){const e=J(),{showForm:o,attendeeSuccess:s}=j(e),a=f(!1),i=()=>{e.setShowFrom(!1)},p=d=>{a.value=d};return Q(()=>{s.value&&(i(),a.value=="true"&&Ie(()=>{e.setShowFrom(!0)}))}),{showForm:o,setAnotherSave:p,hideForm:i}}}),Js={class:"max-h-screen overflow-auto fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-3/4 max-w-4xl"},Ys={class:"bg-white px-6 pb-6 rounded-xl mb-10"},Gs={class:"relative"},Qs=t("h3",{class:"text-lg pt-6"},"Add attendee",-1);function Ws(e,o,s,a,i,p){const d=S("form-attendee");return l(),r("div",{class:x(["transition-all duration-500 delay-50 ease-in-out fixed left-0 top-0 w-screen h-screen",e.showForm?"z-[100] opacity-100 bg-gray-900 bg-opacity-50 poiner-events-all":"z-0 opacity-0 pointer-events-none"])},[t("div",Js,[t("div",Ys,[t("div",Gs,[Qs,e.showForm?(l(),pe(d,{key:0,csrf:e.csrf,event:e.event,onHideForm:e.hideForm,onSaveAnother:e.setAnotherSave},null,8,["csrf","event","onHideForm","onSaveAnother"])):g("",!0)])])])],2)}var Xs=T(js,[["render",Ws]]);const Zs=F({props:{csrf:{type:String,required:!0},event:{type:String,required:!0}}}),en={id:"retour-import-form",method:"post","accept-charset":"UTF-8",enctype:"multipart/form-data"},tn=["value"],on=t("input",{type:"hidden",name:"action",value:"craft-attendees/training/import"},null,-1),sn=["value"],nn=t("input",{type:"file",class:"fixed top-full",name:"file",id:"attendee-csv-file",accept:".csv",onchange:"this.form.submit();"},null,-1),ln=t("label",{for:"attendee-csv-file",class:"bg-gray-300 text-gray-800 font-bold py-2 px-3 text-sm rounded-lg cursor-pointer inline-block"},"Import CSV File",-1);function an(e,o,s,a,i,p){return l(),r("form",en,[t("input",{type:"hidden",name:"CRAFT_CSRF_TOKEN",value:e.csrf},null,8,tn),on,t("input",{type:"hidden",name:"event",value:e.event},null,8,sn),nn,ln])}var rn=T(Zs,[["render",an]]);const dn=F({components:{"button-add":De,"form-import":rn,"popup-add-attendee":Xs,"list-attendees":Ps,"list-support":Ks},props:{csrf:{type:String,required:!0},event:{type:String,required:!0}},setup(){const e=f("attendee");return{activePane:e,handleTabNavigation:s=>{e.value=s}}}}),un={class:"mt-10 w-full relative z-10"},cn={role:"menubar",class:"flex"},pn=t("span",{class:"inline-flex w-4"},null,-1),hn={key:0,class:"bg-gray-100 p-6 pt-10 -mt-2.5 -ml-6 relative"},fn={class:"w-full flex field"},bn=t("div",{class:"heading flex-grow"},[t("label",{class:"text-xl inline-block w-full mb-2"},"Attendees"),t("span",null,"Use the action buttons to either bulk upload from a CSV file or manually manage attendee data.")],-1),gn=t("div",{class:"block bg-gray-100 w-6 left-full pb-6 top-0 h-full absolute"},null,-1),vn=t("div",{class:"block bg-gray-100 h-6 top-full left-0 w-full absolute"},null,-1),mn={key:1,class:"bg-gray-100 p-6 pt-10 -mt-2.5 -ml-6 relative"},_n=t("div",{class:"w-full flex field"},[t("div",{class:"heading flex-grow"},[t("label",{class:"text-xl inline-block w-full mb-2"},"Follow on support"),t("span",null,"Indicate the relevent follow on support offered to attendees of the event.")])],-1),yn=t("div",{class:"block bg-gray-100 w-6 left-full pb-6 top-0 h-full absolute"},null,-1),$n=t("div",{class:"block bg-gray-100 h-6 top-full left-0 w-full absolute"},null,-1);function wn(e,o,s,a,i,p){const d=S("form-import"),c=S("button-add"),u=S("popup-add-attendee"),h=S("list-attendees"),v=S("list-support");return l(),r(D,null,[t("nav",un,[t("ul",cn,[t("li",{role:"menuitem",onClick:o[0]||(o[0]=b=>e.handleTabNavigation("attendee")),class:x(["font-bold text-base text-gray-600 border-b-2 border-solid hover:border-blue-600 pb-2 cursor-pointer",e.activePane==="attendee"?"border-blue-600":"border-gray-100"])}," Attendees ",2),pn,t("li",{role:"menuitem",onClick:o[1]||(o[1]=b=>e.handleTabNavigation("support")),class:x(["font-bold text-base text-gray-600 border-b-2 border-solid hover:border-blue-600 pb-2 cursor-pointer",e.activePane==="support"?"border-blue-600":"border-gray-100"])}," Follow on support ",2)])]),e.activePane==="attendee"?(l(),r("section",hn,[t("div",fn,[bn,N(d,{csrf:e.csrf,event:e.event},null,8,["csrf","event"]),N(c,{label:"Add"})]),N(u,{csrf:e.csrf,event:e.event},null,8,["csrf","event"]),N(h,{csrf:e.csrf,event:e.event},null,8,["csrf","event"]),gn,vn])):g("",!0),e.activePane==="support"?(l(),r("section",mn,[_n,N(v,{csrf:e.csrf,event:e.event},null,8,["csrf","event"]),yn,$n])):g("",!0)],64)}var kn=T(dn,[["render",wn]]);const xn=F({props:{show:{type:Boolean,required:!0},info:{type:String}},setup(e,{emit:o}){return{handleClose:()=>{o("hidePopup")}}}}),Sn={class:"max-h-screen overflow-auto fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-80"},Cn={class:"bg-white p-6 rounded-xl mb-10 relative"},An={key:0,class:"w-full"},Fn=t("div",{class:"w-full mb-2"},[t("h3",{class:"text-lg"},"Organisation / School")],-1),In=t("p",null,"Input expected: Text (Required)",-1),Nn=t("p",null,"This field is the name of the school or organisation associated with the attendee. School names will attempt to match to the schools database, so try to be as accurate as possible.",-1),Tn=[Fn,In,Nn],qn={key:1,class:"w-full"},En=t("div",{class:"w-full mb-2"},[t("h3",{class:"text-lg"},"URN")],-1),Rn=t("p",null,"Input expected: Numeric (Not Required)",-1),Vn=t("p",null,[w("This is the school's Unique Reference Number (URN). This field is not required and can be autocompleted during the import process if not known."),t("br"),t("br"),w("If the cell in the corresponding CSV row contains non-numeric characters or is longer than 8 characters, incorrect formatting will be assumed and null data will be entered.")],-1),Dn=[En,Rn,Vn],Pn={key:2,class:"w-full"},zn=t("div",{class:"w-full mb-2"},[t("h3",{class:"text-lg"},"Postcode")],-1),Un=t("p",null,"Input expected: Alphanumeric (Not required)",-1),Bn=t("p",null,[w("This is the school's post code. This field is not required and can be autocompleted during the import process, however it will assist when trying to match similarly named schools. "),t("br"),t("br"),w("If the cell in the corresponding CSV row exceeds more than 7 characters in length, incorrect formatting will be assumed and null data will be entered.")],-1),Hn=[zn,Un,Bn],On={key:3,class:"w-full"},Mn=t("div",{class:"w-full mb-2"},[t("h3",{class:"text-lg"},"Attendee Name")],-1),Ln=t("p",null,"Input expected: Text (Required)",-1),Kn=t("p",null,[w("The full name of the participant attending the event."),t("br"),t("br"),w("If the cell in the corresponding CSV row exceeds more than 256 characters in length, incorrect formatting will be assumed and null data will be entered. ")],-1),jn=[Mn,Ln,Kn],Jn={key:4,class:"w-full"},Yn=t("div",{class:"w-full mb-2"},[t("h3",{class:"text-lg"},"Attendee Email Address")],-1),Gn=t("p",null,"Input expected: Valid email or blank (Not Required)",-1),Qn=t("p",null,"This field is the valid email of the participant.",-1),Wn=[Yn,Gn,Qn],Xn={key:5,class:"w-full"},Zn=ie('<div class="w-full mb-2"><h3 class="text-lg">Job Role</h3></div><p>Input expected: Text from a predefined list (Required)</p><ul class="text-left"><li><strong>na</strong>: Not Applicable</li><li><strong>support</strong>: Support Staff</li><li><strong>leader-middle</strong>: Middle Leader</li><li><strong>leader</strong>: Leadership</li><li><strong>teacher</strong>: Teacher</li></ul><p>If the cell in the corresponding CSV row does not match one of the list items above, Not Appicable or NA will be selected. </p>',4),el=[Zn],tl={key:6,class:"w-full"},ol=t("div",{class:"w-full mb-2"},[t("h3",{class:"text-lg"},"Attending Days")],-1),sl=t("p",null,"Input expected: Numeric from 1-10 (Not Required)",-1),nl=t("p",null,[w("This field represents the number of days the attendee participated in the event. A number from 1 to 10 is expected."),t("br"),t("br"),w("If the cell in the corresponding CSV row does not match 1-10, 1 will be automatically assumed.")],-1),ll=[ol,sl,nl],al={key:7,class:"w-full"},rl=t("div",{class:"w-full mb-2"},[t("h3",{class:"text-lg"},"Newsletter")],-1),dl=t("p",null,"Input expected: yes/no or y/n or true/false (Not Required)",-1),il=t("p",null,[w("This field informs us if the user wishes their email address be signed up to your Research School's mailing list."),t("br"),t("br"),w("If the cell in the corresponding CSV row does not match any of the expected inputs, no will be automatically assumed. ")],-1),ul=[rl,dl,il];function cl(e,o,s,a,i,p){return l(),r("div",{class:x(["transition-all duration-500 delay-50 ease-in-out fixed left-0 top-0 w-screen h-screen",e.show?"z-[100] opacity-100 bg-gray-900 bg-opacity-50":"z-0 opacity-0 pointer-events-none"])},[t("div",Sn,[t("div",Cn,[e.info===1?(l(),r("div",An,Tn)):g("",!0),e.info===2?(l(),r("div",qn,Dn)):g("",!0),e.info===3?(l(),r("div",Pn,Hn)):g("",!0),e.info===4?(l(),r("div",On,jn)):g("",!0),e.info===5?(l(),r("div",Jn,Wn)):g("",!0),e.info===6?(l(),r("div",Xn,el)):g("",!0),e.info===7?(l(),r("div",tl,ll)):g("",!0),e.info===8?(l(),r("div",al,ul)):g("",!0),t("button",{onClick:o[0]||(o[0]=(...d)=>e.handleClose&&e.handleClose(...d)),class:"block bg-gray-300 text-gray-800 font-bold mt-2 py-2 px-3 text-sm rounded-lg cursor-pointer absolute right-2 top-0"}," \u2715 ")])])],2)}var pl=T(xn,[["render",cl]]);const hl=F({components:{draggable:Ne,"popup-import":pl},props:{headers:{type:String,required:!0},filename:{type:String,default:""},parent:{type:String,default:""},csv:{type:String,required:!0},event:{type:String,required:!0}},setup(e){const o=f([{id:1,name:"Organisation / School",required:!0,info:"Text"},{id:2,name:"URN",required:!1,info:"Number"},{id:3,name:"Postcode",required:!1,info:"Text"},{id:4,name:"Attendee Name",required:!0,info:"Text"},{id:5,name:"Attendee Email Address",required:!1,info:"Text"},{id:6,name:"Job Role",required:!0,info:"Text exact match [na, support, leader-middle, leader, teacher]"},{id:7,name:"Attending Days",required:!0,info:"Number between 1 - 10"},{id:8,name:"Newsletter",required:!1,info:"Yes | No"}]),s=f(JSON.parse(e.headers)),a=f(o.value.length>s.value.length?o.value.length-s.value.length:0),i=f(!1),p=f(null);for(let b=0;b<a.value;b++)s.value.push("");return s.value=s.value.map((b,n)=>({id:n,value:b})),{values:o,csvHeaders:s,popupId:p,showPopup:i,handleRemove:b=>{console.log("map?",b),s.value=s.value.map(n=>n.value===b?{id:n.id,value:""}:n)},handleSubmit:()=>{console.log("submit")},handleCancel:()=>{var b;window.location.href=((b=e.parent)==null?void 0:b.length)>0?e.parent:"/"},handleHidePopup:()=>{i.value=!1,p.value=null},handleShowInfo:b=>{i.value=!0,p.value=b}}}}),fl={class:"bg-gray-100 p-6 pt-10 -ml-6 relative mt-10"},bl={class:"w-full flex field"},gl={class:"heading flex-grow"},vl=t("label",{class:"text-xl inline-block w-full mb-2"},"Map fields into the correct data",-1),ml=t("span",null,[w("Choose the fields to import into the attendees from the CSV file by dragging them"),t("br"),w("in the appropriate order. Click on the \u2715 to delete an unused field.")],-1),_l={class:"mt-4 w-full"},yl=["href"],$l={class:"flex w-full items-start mt-10"},wl={class:"flex-grow"},kl={class:"mb-4"},xl=t("span",{class:"font-primary text-lg font-bold block pb-2"},"CSV File fields",-1),Sl={class:"block h-10"},Cl={key:0,class:"bg-white rounded-xl mb-2 w-full px-4 box-border flex items-center cursor-move h-12 pt-2"},Al=t("span",{class:"text-blue-600 text-xl leading-0"},"\u2725",-1),Fl={class:"font-bold flex-grow"},Il=["onClick"],Nl={key:1,class:"bg-gray-200 rounded-xl mb-2 w-full px-4 box-border flex items-center cursor-move h-12 pt-2"},Tl=t("span",{class:"text-blue-600 text-xl leading-0"},"\u2725",-1),ql=t("span",{class:"italic text-gray-400"},"No value specified",-1),El=[Tl,ql],Rl={class:"w-20 pt-20 mt-2.5"},Vl=t("span",{class:"text-blue-600 inline-block text-xl"},"\u2192",-1),Dl=[Vl],Pl={class:"flex-grow"},zl={class:"mb-4"},Ul=t("span",{class:"font-primary text-lg font-bold block pb-2"},"Attendees fields",-1),Bl={class:"block h-10"},Hl={class:"font-bold inline-flex flex-grow items-center"},Ol={key:0,class:"text-blue-500 inline-block pl-1 font-normal text-xs"},Ml={key:0,class:"text-gray-400 italic text-xs"},Ll=["onClick"],Kl=t("div",{class:"block bg-gray-100 w-6 left-full pb-6 top-0 h-full absolute"},null,-1),jl=t("div",{class:"block bg-gray-100 h-6 top-full left-0 w-full absolute"},null,-1);function Jl(e,o,s,a,i,p){const d=S("draggable"),c=S("popup-import");return l(),r("section",fl,[t("div",bl,[t("div",gl,[vl,ml,t("div",_l,[t("a",{href:e.csv,target:"_blank",download:"",class:"bg-gray-300 text-gray-800 font-bold py-2 px-3 text-sm rounded-lg cursor-pointer inline-block"},"Download CSV template",8,yl)])]),t("button",{class:"bg-gray-300 text-gray-800 font-bold py-2 px-3 text-sm rounded-lg cursor-pointer",onClick:o[0]||(o[0]=(...u)=>e.handleCancel&&e.handleCancel(...u))},"Cancel"),t("button",{class:"bg-emerald-300 text-emerald-800 font-bold py-2 px-3 text-sm rounded-lg cursor-pointer",onClick:o[1]||(o[1]=(...u)=>e.handleSubmit&&e.handleSubmit(...u))},"Start import")]),t("div",$l,[t("div",wl,[t("div",kl,[xl,t("span",Sl,"from: "+_(e.filename),1)]),N(d,{list:e.csvHeaders},{default:Te(()=>[(l(!0),r(D,null,W(e.csvHeaders,u=>(l(),r("div",{key:u.id},[u.value!==""?(l(),r("div",Cl,[Al,t("span",Fl,_(u.value),1),t("button",{onClick:h=>e.handleRemove(u.value),class:"text-gray-600 cursor-pointer"},"\u2715",8,Il)])):(l(),r("div",Nl,El))]))),128))]),_:1},8,["list"])]),t("div",Rl,[(l(!0),r(D,null,W(e.csvHeaders,u=>(l(),r("div",{key:u,class:"mb-2 w-full px-4 box-border flex items-center justify-center cursor-move h-12 pt-2"},Dl))),128))]),t("div",Pl,[t("div",zl,[Ul,t("span",Bl,"to: "+_(e.event),1)]),(l(!0),r(D,null,W(e.values,u=>(l(),r("div",{key:u.id,class:"bg-white rounded-xl mb-2 w-full px-4 box-border flex items-center h-12 pt-2 leading-[0]"},[t("span",Hl,[w(_(u.name)+" ",1),u.required?(l(),r("span",Ol,"[required]")):g("",!0)]),u.info?(l(),r("span",Ml,_(u.info),1)):g("",!0),t("button",{onClick:h=>e.handleShowInfo(u.id),class:"text-blue-800 cursor-pointer"},"\u24D8",8,Ll)]))),128))])]),N(c,{show:e.showPopup,onHidePopup:e.handleHidePopup,info:e.popupId},null,8,["show","onHidePopup","info"]),Kl,jl])}var Yl=T(hl,[["render",Jl]]);const Gl=F({components:{"list-csv":Yl,"tabpane-attendees":kn}}),Ql=async()=>{const e=qe(de({},Gl));e.use(Ee()),e.mount("#training")};Ql().then(e=>{});
//# sourceMappingURL=attendees.7c3848bd.js.map

/* empty css            */import{A as z,B as T,d as _,s as S,f as F,I as B,c as m,o as p,p as M,r as y,w as C,l as $,a as r,t as w,m as j,k as A,J as N,z as b,b as k,n as E,F as P,G as V,H as L}from"./vendor.ddcec68c.js";import{_ as x,u as Y}from"./plugin-vue_export-helper.70ac9843.js";var D,I;const H=(I=(D=window==null?void 0:window.Attendee)==null?void 0:D.cpUrl)!=null?I:"https://researchschool.org.uk/cp",O=z("trainings",{state:()=>({events:null,attendees:null,followOnSupport:null,followOnSupportOptions:null,period:3,site:"main",loading:!1}),actions:{fetchEvents(){const e=this;this.loading=!0;const t=this.site,u=this.period;T({method:"get",url:`${H}/craft-attendees/dashboard/events/${t}/${u}`}).then(function(o){var a,d,s,l;e.loading=!1,e.events=(a=o==null?void 0:o.data)==null?void 0:a.events,e.attendees=(d=o==null?void 0:o.data)==null?void 0:d.attendees,e.followOnSupport=(s=o==null?void 0:o.data)==null?void 0:s.follow_on_support,e.followOnSupportOptions=(l=o==null?void 0:o.data)==null?void 0:l.follow_on_support_options})}}}),q=_({setup(){const e=O(),{period:t}=S(e);return{period:t,handlePeriodChanged:o=>{e.period=parseInt(o.currentTarget.value),e.fetchEvents()}}}}),U=M('<option value="2022">Academic Year (2021/22)</option><option value="2021">Academic Year (2020/21)</option><option value="2020">Academic Year (2019/20)</option><option value="3">Last 3 months</option><option value="6">Last 6 months</option>',5),R=[U];function G(e,t,u,o,a,d){return F((p(),m("select",{name:"period",class:"block h-10 px-1 rounded-md bg-gray-300 border-gray-300","onUpdate:modelValue":t[0]||(t[0]=s=>e.period=s),onChange:t[1]||(t[1]=(...s)=>e.handlePeriodChanged&&e.handlePeriodChanged(...s))},R,544)),[[B,e.period]])}var J=x(q,[["render",G]]);const K=_({components:{dropdown:J},setup(){const e=O(),{period:t}=S(e),u=y("-"),o=y("-");return C(()=>{if(t.value)if(t.value<12){let a=new Date;o.value=a.getDate()+" "+a.toLocaleString("default",{month:"long"})+" "+a.getFullYear(),a.setMonth(a.getMonth()-t.value),u.value=a.getDate()+" "+a.toLocaleString("default",{month:"long"})+" "+a.getFullYear()}else{let a=new Date(`31 july ${t.value}`),d=new Date(`01 september ${t.value-1}`);o.value=a.getDate()+" "+a.toLocaleString("default",{month:"long"})+" "+a.getFullYear(),u.value=d.getDate()+" "+d.toLocaleString("default",{month:"long"})+" "+d.getFullYear()}}),{start:u,end:o}}}),Q={class:"flex w-full sticky z-20 bg-gray-100 bg-opacity-70 py-4 backdrop-blur",style:{top:"50px"}},W={class:"text-xl font-bold inline-block flex-grow",style:{"margin-bottom":"0!important"}},X=A("Showing data from "),Z=A(" to "),ee={style:{"margin-top":"0!important"}};function te(e,t,u,o,a,d){const s=$("dropdown");return p(),m("div",Q,[r("p",W,[X,r("strong",null,w(e.start),1),Z,r("strong",null,w(e.end),1)]),r("div",ee,[j(s)])])}var oe=x(K,[["render",te]]);const se=_({components:{apexchart:N},setup(){const e=y({chart:{id:"engagement-levels",stacked:!0,stackType:"100%"},plotOptions:{bar:{horizontal:!0}},theme:{palette:"palette3"},legend:{show:!1},xaxis:{labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{show:!1},colors:["#2b63eb","#113795"]}),t=y([{name:"Attendees",data:[0]},{name:"Attendees (100% verified)",data:[0]}]),u=Y(),{loading:o,events:a,attendees:d}=S(u),s=y(0),l=y(0),g=y(0);return C(()=>{if(d.value){const v=d.value.reduce(function(h,i){return h[i.eventId]=h[i.eventId]||[],h[i.eventId].push(i),h},Object.create(null));s.value=Object.keys(v).length,Object.values(v).forEach((h,i)=>{l.value=l.value+h.length;let c=!0;for(const n in h)h[n].approved!=1&&(c=!1);c&&(g.value=g.value+1)}),t.value[0].data[0]=s.value,t.value[1].data[0]=g.value}}),{loading:o,chartOptions:e,series:t,events:a,allAttendees:s,totalAttendeesAreApproved:g,attendees:d}}}),ne={class:"bg-white p-4 rounded-xl mb-4"},ae=r("p",{class:"font-bold text-lg"},"Engagement Data Completion",-1),le={key:1,class:"text-xl w-full inline-block text-center text-gray-400"},re=A(" total training events, "),ie={key:2,class:"block relative flex items-center justify-center w-full",style:{height:"150px"}},ce=r("svg",{class:"animate-spin ml-2 mt-1 h-8 w-8 text-gray-400 inline-block -mt-px",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",style:{"margin-bottom":"0!important"}},[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),pe=[ce];function de(e,t,u,o,a,d){var l,g,v,h,i;const s=$("apexchart");return p(),m("article",ne,[ae,!e.loading&&((l=e.attendees)==null?void 0:l.length)>0?(p(),b(s,{key:0,height:"150",type:"bar",options:e.chartOptions,series:e.series},null,8,["options","series"])):k("",!0),!e.loading&&((g=e.attendees)==null?void 0:g.length)===0?(p(),m("p",le,"There is no data to preview")):k("",!0),r("span",{class:E(["block w-full text-center py-2",e.loading||((v=e.attendees)==null?void 0:v.length)===0?"opacity-0":""])},[r("strong",null,w((h=e.events)==null?void 0:h.length),1),re,r("strong",null,w(e.allAttendees),1),A(" have attendees and ("+w(((i=e.events)==null?void 0:i.length)*e.totalAttendeesAreApproved)+"%) are verified.",1)],2),e.loading?(p(),m("span",ie,pe)):k("",!0)])}var ue=x(se,[["render",de]]);const he=_({props:{value:{type:Number,required:!0},type:{type:String,required:!0},average:{type:Number,required:!0},description:{type:String,required:!0}}}),ge={class:"bg-white rounded-xl p-4"},ve={class:"flex items-end pb-2",style:{"align-items":"end"}},me={class:"text-6xl block text-blue-600",style:{"margin-bottom":"0!important"}},fe={class:"block pb-1",style:{"margin-bottom":"0!important"}},ye={class:"block pb-1 text-xs"},be=A("Avg. ");function _e(e,t,u,o,a,d){return p(),m("article",ge,[r("span",ve,[r("span",me,w(e.value),1),r("span",fe,w(e.type),1)]),r("span",ye,[be,r("strong",null,w(e.average),1),A(" "+w(e.description),1)])])}var $e=x(he,[["render",_e]]);const we=_({setup(){const e=O(),{loading:t}=S(e);return{loading:t}}}),ke={class:"bg-white rounded-xl p-4"},xe={key:0},Se=r("span",{class:"animate-pulse flex items-end pb-2",style:{"align-items":"end"}},[r("span",{class:"text-6xl block text-blue-600 bg-blue-600 bg-opacity-10 rounded-md",style:{"margin-bottom":"0!important"}},"\xA0\xA0\xA0\xA0\xA0\xA0"),r("span",{class:"block pb-1 bg-gray-200 bg-opacity-50 flex-grow rounded-md",style:{"margin-bottom":"0!important"}},"\xA0")],-1),Oe=r("span",{class:"animate-pulse block pb-1 text-xs bg-gray-200 bg-opacity-50 rounded-md"},"\xA0",-1),Ae=[Se,Oe],je={key:1,class:"flex items-center justify-center w-full h-full font-bold"};function Ce(e,t,u,o,a,d){return p(),m("article",ke,[e.loading?(p(),m("div",xe,Ae)):(p(),m("div",je," There is no data to preview "))])}var Ne=x(we,[["render",Ce]]);const Ee=_({components:{stat:$e,"stat-empty":Ne},setup(){const e=O(),{loading:t,events:u,attendees:o,period:a}=S(e);return{loading:t,events:u,attendees:o,schools:()=>{const i=o.value.reduce(function(c,n){return c[n.orgName]=c[n.orgName]||[],c[n.orgName].push(n),c},Object.create(null));return Object.keys(i).length},priority:()=>{const i=o.value.reduce(function(c,n){return c[n.priority]=c[n.priority]||[],c[n.priority].push(n),c},Object.create(null));return isNaN(Object.keys(i).length)?Object.keys(i).length:0},averageEvents:()=>Math.ceil(u.value.length/a.value),averageAttendees:()=>{const i=o.value.reduce(function(c,n){return c[n.eventId]=c[n.eventId]||[],c[n.eventId].push(n),c},Object.create(null));return Object.keys(i).length},averageSchools:()=>{const i=o.value.reduce(function(n,f){return n[f.orgName]=n[f.orgName]||[],n[f.orgName].push(f),n},Object.create(null));let c=Object.values(i).map(n=>n.length);return c=Math.ceil(c.reduce((n,f)=>n+f,0)/c.length),isNaN(c)?0:c},averagePrioritySchools:()=>{let i=o.value.filter(n=>n.priority===1);i=i.reduce(function(n,f){return n[f.eventId]=n[f.eventId]||[],n[f.eventId].push(f),n},Object.create(null));let c=Object.values(i).map(n=>n.length);return c=Math.ceil(c.reduce((n,f)=>n+f,0)/c.length),isNaN(c)?0:c}}}}),De={class:"grid grid-cols-2 xl:grid-cols-4 gap-4"};function Ie(e,t,u,o,a,d){const s=$("stat"),l=$("stat-empty");return p(),m("div",De,[e.events&&!e.loading?(p(),b(s,{key:0,value:e.events.length,average:e.averageEvents(),type:"event",description:"trainings per month"},null,8,["value","average"])):(p(),b(l,{key:1})),e.attendees&&!e.loading?(p(),b(s,{key:2,value:e.attendees.length,average:e.averageAttendees(),type:"attendees",description:"attendees per training"},null,8,["value","average"])):(p(),b(l,{key:3})),e.attendees&&!e.loading?(p(),b(s,{key:4,value:e.schools(),average:e.averageSchools(),type:"schools",description:"schools per training"},null,8,["value","average"])):(p(),b(l,{key:5})),e.attendees&&!e.loading?(p(),b(s,{key:6,value:e.priority(),average:e.averagePrioritySchools(),type:"priority schools",description:"priority schools per training"},null,8,["value","average"])):(p(),b(l,{key:7}))])}var ze=x(Ee,[["render",Ie]]);const Te=_({components:{apexchart:N},setup(){const e=y({chart:{id:"engagement-levels",stacked:!0,stackType:"100%"},plotOptions:{bar:{horizontal:!0}},theme:{palette:"palette3"},legend:{position:"top"},xaxis:{labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{show:!1},colors:["#2b63eb","#113795","#07205b"]}),t=y([{name:"Engaged (1 module)",data:[0]},{name:"Sustained (2 modules)",data:[0]},{name:"Embedded (3+ modules)",data:[0]}]),u=O(),{loading:o,attendees:a}=S(u);return C(()=>{if(a.value){const d=a.value.reduce(function(s,l){return s[l.days]=s[l.days]||[],s[l.days].push(l),s},Object.create(null));for(const s in Object.keys(d)){const l=s<3?s:2;t.value[l].data[0]=parseInt(t.value[l].data[0])+Object.values(d)[s].length}}}),{loading:o,chartOptions:e,series:t,attendees:a}}}),Fe={class:"bg-white p-4 rounded-xl mb-4"},Be=r("p",{class:"font-bold text-lg"},"Engagement level",-1),Me={key:1,class:"text-xl w-full inline-block text-center text-gray-400"},Pe={key:2,class:"block relative flex items-center justify-center w-full",style:{height:"150px"}},Ve=r("svg",{class:"animate-spin ml-2 mt-1 h-8 w-8 text-gray-400 inline-block -mt-px",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",style:{"margin-bottom":"0!important"}},[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),Le=[Ve];function Ye(e,t,u,o,a,d){var l,g,v;const s=$("apexchart");return p(),m("article",Fe,[Be,!e.loading&&((l=e.attendees)==null?void 0:l.length)>0?(p(),b(s,{key:0,height:"150",type:"bar",options:e.chartOptions,series:e.series},null,8,["options","series"])):k("",!0),!e.loading&&((g=e.attendees)==null?void 0:g.length)===0?(p(),m("p",Me,"There is no data to preview")):k("",!0),r("span",{class:E(["block w-full text-center py-2",e.loading||((v=e.attendees)==null?void 0:v.length)===0?"opacity-0":""])},"Showing the split of engagement levels across all events in this time period",2),e.loading?(p(),m("span",Pe,Le)):k("",!0)])}var He=x(Te,[["render",Ye]]);const qe=_({components:{apexchart:N},setup(e){const t=y({chart:{id:"follow-on-support"},plotOptions:{bar:{horizontal:!0,height:"10%"}},theme:{palette:"palette3"},legend:{position:"top"},xaxis:{categories:[]},yaxis:{labels:{style:{fontSize:"14px",fontFamily:'system-ui,BlinkMacSystemFont,-apple-system,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif'}}},colors:["#2b63eb","#113795","#07205b"]}),u=y([{name:"Follow on support",data:[]}]),o=O(),{loading:a,followOnSupport:d,followOnSupportOptions:s}=S(o);return C(()=>{var l;if(d.value){const g=d.value.reduce(function(h,i){return h[i.optionId]=h[i.optionId]||[],h[i.optionId].push(i),h},Object.create(null));let v=[];for(const h in g)v.push((l=s.value.find(i=>i.id==h))==null?void 0:l.name);t.value.xaxis.categories=v,u.value[0].data=[],Object.values(g).forEach((h,i)=>{u.value[0].data.push(h.length)})}}),{chartOptions:t,series:u,loading:a,followOnSupport:d}}}),Ue={class:"bg-white p-4 rounded-xl mb-4"},Re=r("p",{class:"font-bold text-lg"},"Follow on support",-1),Ge={key:1,class:"text-xl w-full inline-block text-center text-gray-400 flex items-center justify-center w-full block",style:{height:"800px"}},Je=r("span",null,"There is no data to preview",-1),Ke=[Je],Qe={key:2,class:"block relative flex items-center justify-center w-full",style:{height:"800px"}},We=r("svg",{class:"animate-spin ml-2 mt-1 h-8 w-8 text-gray-400 inline-block -mt-px",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",style:{"margin-bottom":"0!important"}},[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),Xe=[We];function Ze(e,t,u,o,a,d){var l,g,v;const s=$("apexchart");return p(),m("article",Ue,[Re,!e.loading&&((l=e.followOnSupport)==null?void 0:l.length)>0?(p(),b(s,{key:0,height:"800px",type:"bar",options:e.chartOptions,series:e.series},null,8,["options","series"])):k("",!0),!e.loading&&((g=e.followOnSupport)==null?void 0:g.length)===0?(p(),m("p",Ge,Ke)):k("",!0),r("span",{class:E(["block w-full text-center py-2",e.loading||((v=e.followOnSupport)==null?void 0:v.length)===0?"opacity-0":""])},"Showing what types of follow on support have been offered.",2),e.loading?(p(),m("span",Qe,Xe)):k("",!0)])}var et=x(qe,[["render",Ze]]);const tt=_({components:{"stats-completion":ue,"stats-figures":ze,"stats-levels":He,"stats-support":et},props:{site:{type:String,required:!0}},setup(e){const t=O();S(t),t.site=e.site=="*"?2:e.site,t.fetchEvents()}});function ot(e,t,u,o,a,d){const s=$("stats-figures"),l=$("stats-levels"),g=$("stats-support"),v=$("stats-completion");return p(),m(P,null,[j(s),j(l),j(g),j(v)],64)}var st=x(tt,[["render",ot]]);const nt=_({components:{"header-dashboard":oe,"stats-dashboard":st}}),at=async()=>{const e=V(nt);return e.use(L()),e.mount("#dashboard")};at().then(e=>{});
//# sourceMappingURL=dashboard.123bbb08.js.map

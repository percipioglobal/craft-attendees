import{A as p,B as h}from"./vendor.bd85c310.js";var g,f;const r=(f=(g=window==null?void 0:window.Attendee)==null?void 0:g.cpUrl)!=null?f:"https://researchschool.org.uk/cp",A=p("trainings",{state:()=>({attendees:null,totalAttendees:null,attendeeInput:null,attendeeFormErrors:!1,attendeeSuccess:!1,showForm:!1,loading:!1,loadingApi:!1,schools:null,followOnSupportOptions:null,order:"date"}),actions:{fetchOptions(n){const t=this;this.loading=!0,h({method:"get",url:`${r}/craft-attendees/trainings/fetch-support-options/${n}`}).then(function(i){var e,s;t.loading=!1,t.followOnSupportOptions=(e=i.data)==null?void 0:e.options,t.followOnSupportSelectedOptions=(s=i.data)==null?void 0:s.selectedOptions})},saveOption(n){const t=this;this.loading=!0,h({method:"post",url:`${r}/actions/craft-attendees/training/save-support-options`,data:n}).then(function(i){t.loading=!1})},async fetchSchools(n){var t;if(n){this.loadingApi=!0;const e=await h.create({baseURL:`https://api.v2.metaseed.io/schools/?mode=legacy&query=${n}`,timeout:3e3}).get("");(e==null?void 0:e.data)?(this.schools=(t=e.data)==null?void 0:t.suggestions,this.loadingApi=!1):this.loadingApi=!1}},deleteAttendees(n){const t=this;this.loading=!0,h({method:"post",url:`${r}/actions/craft-attendees/training/delete`,data:n}).then(function(i){t.loading=!1,n.attendees.forEach(e=>{t.attendees=t.attendees.filter(s=>s.id!=e)})})},submitAttendee(n){let t={};if(n instanceof FormData)for(var i of n.entries())t[i[0]]=i[1];else t=n;this.attendeeFormErrors=!1,this.loading=!0,this.attendeeSuccess=!1,this.attendeeInput=t;const e=this;h({method:"post",url:`${r}/actions/craft-attendees/training/save`,data:n}).then(function(s){var o;if(!s.data.success)e.attendeeFormErrors=s.data.errors,e.loading=!1,e.attendeeSuccess=!1;else{let a=e.attendees.filter(c=>{var d,l;return c.id==((l=(d=s==null?void 0:s.data)==null?void 0:d.attendee)==null?void 0:l.id)});const u=e.attendees.findIndex(c=>{var d,l;return c.id==((l=(d=s==null?void 0:s.data)==null?void 0:d.attendee)==null?void 0:l.id)});a.length>0?(a=a[0],a.name=t==null?void 0:t.name,a.orgName=t==null?void 0:t.orgName,a.orgUrn=parseInt(t==null?void 0:t.orgUrn),a.postCode=t==null?void 0:t.postCode,a.days=t==null?void 0:t.days,a.email=t==null?void 0:t.email,a.newsletter=t==null?void 0:t.newsletter,a.approved=t==null?void 0:t.approved,a.jobRole=t==null?void 0:t.jobRole,a.priority=t==null?void 0:t.priority,a.anonymous=t==null?void 0:t.anonymous,e.attendees[u]=a):e.attendees.unshift((o=s==null?void 0:s.data)==null?void 0:o.attendee),e.loading=!1,e.attendeeFormErrors=!1,e.attendeeSuccess=!0,e.attendeeInput=null}})},fetchAttendees(n,t,i,e,s=!1){const o=this;this.loading=!0,this.order=t,s&&(this.attendees=[]),h({method:"get",url:`${r}/craft-attendees/trainings/attendees/${n}/${t}/${i}/${e}`}).then(function(a){var u,c,d,l;o.loading=!1,o.totalAttendees=parseInt((c=(u=a==null?void 0:a.data)==null?void 0:u.meta)==null?void 0:c.total),o.attendees=e!==0?o.attendees.concat((d=a==null?void 0:a.data)==null?void 0:d.attendees):(l=a==null?void 0:a.data)==null?void 0:l.attendees})},setShowFrom(n){this.attendeeFormErrors=!1,this.showForm=n},resetForm(){this.loading=!1,this.attendeeFormErrors=!1,this.attendeeInput=null},clearSchools(){this.schools=null}}});var v=(n,t)=>{const i=n.__vccOpts||n;for(const[e,s]of t)i[e]=s;return i};export{v as _,A as u};
//# sourceMappingURL=plugin-vue_export-helper.6466da38.js.map

/* empty css            */import{A as N,B as V,d as m,s as x,f as D,H as P,c as h,o as r,p as q,l as f,a as n,t as _,m as C,I as H,k as A,J as F,r as b,w as j,z as v,b as $,n as I,F as M,E as R,G as U}from"./vendor.bd85c310.js";import{_ as w}from"./plugin-vue_export-helper.21dcd24c.js";import{u as L}from"./trainings.96c469cc.js";var E,T;const Y=(T=(E=window==null?void 0:window.Attendee)==null?void 0:E.cpUrl)!=null?T:"https://researchschool.org.uk/cp";var z,B;const G=(B=(z=window==null?void 0:window.Attendee)==null?void 0:z.csrf)!=null?B:"",S=N("trainings",{state:()=>({events:null,attendees:null,unverifiedAttendees:null,followOnSupport:null,followOnSupportOptions:null,totals:[],period:3,site:"main",loading:!1}),actions:{fetchEvents(e){const s=this;this.loading=!0;const d=this.site,p=this.period,c={CRAFT_CSRF_TOKEN:G,site:d,period:p};V({method:"post",url:`${Y}/actions/craft-attendees/dashboard/events`,data:c}).then(function(t){var o,a,l,i,g,u;s.loading=!1,s.events=(o=t==null?void 0:t.data)==null?void 0:o.events,s.attendees=(a=t==null?void 0:t.data)==null?void 0:a.attendees,s.unverifiedAttendees=(l=t==null?void 0:t.data)==null?void 0:l.unverified_attendees,s.followOnSupport=(i=t==null?void 0:t.data)==null?void 0:i.follow_on_support,s.followOnSupportOptions=(g=t==null?void 0:t.data)==null?void 0:g.follow_on_support_options,s.totals=(u=t==null?void 0:t.data)==null?void 0:u.totals})}}}),J=m({setup(){const e=S(),{loading:s,period:d}=x(e);return{loading:s,period:d,handlePeriodChanged:c=>{e.period=parseInt(c.currentTarget.value),e.fetchEvents()}}}}),K=["disabled"],Q=q('<option value="2022">Academic Year (2021/22)</option><option value="2021">Academic Year (2020/21)</option><option value="2020">Academic Year (2019/20)</option><option value="3">Last 3 months</option><option value="6">Last 6 months</option>',5),W=[Q];function X(e,s,d,p,c,t){return D((r(),h("select",{name:"period",class:"block h-10 px-1 rounded-md bg-gray-300 border-gray-300","onUpdate:modelValue":s[0]||(s[0]=o=>e.period=o),disabled:e.loading,onChange:s[1]||(s[1]=(...o)=>e.handlePeriodChanged&&e.handlePeriodChanged(...o))},W,40,K)),[[P,e.period]])}var Z=w(J,[["render",X]]);const ee=m({components:{dropdown:Z},props:{start:{type:String,required:!0},end:{type:String,required:!0}},setup(){const e=S(),{loading:s}=x(e);return{loading:s}}}),te={class:"flex w-full sticky z-20 bg-gray-100 bg-opacity-70 py-4 backdrop-blur",style:{top:"50px"}},se={class:"text-xl font-bold inline-block flex-grow",style:{"margin-bottom":"0!important"}},oe=A("Showing data from "),ae=A(" to "),ne={style:{"margin-top":"0!important"}};function le(e,s,d,p,c,t){const o=f("dropdown");return r(),h("div",te,[n("p",se,[oe,n("strong",null,_(e.start),1),ae,n("strong",null,_(e.end),1)]),n("div",ne,[C(o),H(e.$slots,"default")])])}var re=w(ee,[["render",le]]);const ie=m({components:{apexchart:F},setup(){const e=b({chart:{id:"engagement-levels",stacked:!0,stackType:"100%"},plotOptions:{bar:{horizontal:!0}},theme:{palette:"palette3"},legend:{show:!1},xaxis:{labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{show:!1},colors:["#2b63eb","#113795"]}),s=b([{name:"Attendees (unverified)",data:[0]},{name:"Attendees (100% verified)",data:[0]}]),d=L(),{loading:p,totals:c,attendees:t,unverifiedAttendees:o}=x(d),a=b(0);b(0);const l=b(0);return j(()=>{var i,g;if(t.value){let u=[];for(const k in t.value)for(const O in t.value[k])u[""+t.value[k][O].eventId]=((i=u[""+t.value[k][O].eventId])!=null?i:0)+1;let y=[];for(const k in o.value)for(const O in o.value[k])y[""+o.value[k][O].eventId]=((g=y[""+o.value[k][O].eventId])!=null?g:0)+1;a.value=Object.keys(u).length+Object.keys(y).length,l.value=Object.keys(u).length,s.value[0].data[0]=a.value,s.value[1].data[0]=l.value}}),{loading:p,chartOptions:e,series:s,totals:c,allAttendees:a,totalAttendeesAreApproved:l,attendees:t}}}),ce={class:"bg-white p-4 rounded-xl mb-4"},de=n("p",{class:"font-bold text-lg"},"Engagement Data Completion",-1),pe={key:1,class:"text-xl w-full inline-block text-center text-gray-400"},ue=A(" total training events, "),he={key:2,class:"block relative flex items-center justify-center w-full",style:{height:"150px"}},ge=n("svg",{class:"animate-spin ml-2 mt-1 h-8 w-8 text-gray-400 inline-block -mt-px",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",style:{"margin-bottom":"0!important"}},[n("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),n("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),ve=[ge];function me(e,s,d,p,c,t){var a,l,i;const o=f("apexchart");return r(),h("article",ce,[de,!e.loading&&((a=e.attendees)==null?void 0:a.length)>0?(r(),v(o,{key:0,height:"150",type:"bar",options:e.chartOptions,series:e.series},null,8,["options","series"])):$("",!0),!e.loading&&((l=e.attendees)==null?void 0:l.length)===0?(r(),h("p",pe,"There is no data to preview")):$("",!0),n("span",{class:I(["block w-full text-center py-2",e.loading||((i=e.attendees)==null?void 0:i.length)===0?"opacity-0":""])},[n("strong",null,_(e.totals.events),1),ue,n("strong",null,_(e.allAttendees),1),A(" have attendees and ("+_(e.totals.events/100*e.totalAttendeesAreApproved*100)+"%) are verified.",1)],2),e.loading?(r(),h("span",he,ve)):$("",!0)])}var fe=w(ie,[["render",me]]);const ye=m({props:{value:{type:Number,required:!0},type:{type:String,required:!0},average:{type:Number,required:!0},description:{type:String,required:!0}}}),_e={class:"bg-white rounded-xl p-4"},be={class:"flex items-end pb-2",style:{"align-items":"end"}},$e={class:"text-6xl block text-blue-600",style:{"margin-bottom":"0!important"}},we={class:"block pb-1",style:{"margin-bottom":"0!important"}},ke={class:"block pb-1 text-xs"},xe=A("Avg. ");function Se(e,s,d,p,c,t){return r(),h("article",_e,[n("span",be,[n("span",$e,_(e.value),1),n("span",we,_(e.type),1)]),n("span",ke,[xe,n("strong",null,_(e.average),1),A(" "+_(e.description),1)])])}var Ae=w(ye,[["render",Se]]);const Oe=m({setup(){const e=S(),{loading:s}=x(e);return{loading:s}}}),Ce={class:"bg-white rounded-xl p-4"},Fe={key:0},je=n("span",{class:"animate-pulse flex items-end pb-2",style:{"align-items":"end"}},[n("span",{class:"text-6xl block text-blue-600 bg-blue-600 bg-opacity-10 rounded-md",style:{"margin-bottom":"0!important"}},"\xA0\xA0\xA0\xA0\xA0\xA0"),n("span",{class:"block pb-1 bg-gray-200 bg-opacity-50 flex-grow rounded-md",style:{"margin-bottom":"0!important"}},"\xA0")],-1),Ie=n("span",{class:"animate-pulse block pb-1 text-xs bg-gray-200 bg-opacity-50 rounded-md"},"\xA0",-1),Ee=[je,Ie],Te={key:1,class:"flex items-center justify-center w-full h-full font-bold"};function ze(e,s,d,p,c,t){return r(),h("article",Ce,[e.loading?(r(),h("div",Fe,Ee)):(r(),h("div",Te," There is no data to preview "))])}var Be=w(Oe,[["render",ze]]);const Ne=m({components:{stat:Ae,"stat-empty":Be},setup(){const e=S(),{loading:s,events:d,attendees:p,period:c,totals:t}=x(e);return{loading:s,events:d,attendees:p,totals:t,averageEvents:()=>Math.ceil(d.value.length/c.value).toFixed(2).replace(/[.,]00$/,""),averageAttendees:()=>parseFloat(t.value.attendees/t.value.events).toFixed(2).replace(/[.,]00$/,""),averageSchools:()=>parseFloat(t.value.schools/t.value.events).toFixed(2).replace(/[.,]00$/,""),averagePrioritySchools:()=>parseFloat(t.value.priority/t.value.events).toFixed(2).replace(/[.,]00$/,"")}}}),Ve={class:"grid grid-cols-2 xl:grid-cols-4 gap-4"};function De(e,s,d,p,c,t){var l,i,g,u;const o=f("stat"),a=f("stat-empty");return r(),h("div",Ve,[e.events&&!e.loading?(r(),v(o,{key:0,value:parseInt((l=e.totals.events)!=null?l:e.events.length),average:parseFloat(e.averageEvents()),type:"events",description:"trainings per month"},null,8,["value","average"])):(r(),v(a,{key:1})),e.attendees&&!e.loading?(r(),v(o,{key:2,value:parseInt((i=e.totals.attendees)!=null?i:e.attendees.length),average:parseFloat(e.averageAttendees()),type:"attendees",description:"attendees per training"},null,8,["value","average"])):(r(),v(a,{key:3})),e.attendees&&!e.loading?(r(),v(o,{key:4,value:parseInt((g=e.totals.schools)!=null?g:0),average:parseFloat(e.averageSchools()),type:"schools",description:"schools per training"},null,8,["value","average"])):(r(),v(a,{key:5})),e.attendees&&!e.loading?(r(),v(o,{key:6,value:parseInt((u=e.totals.priority)!=null?u:0),average:parseFloat(e.averagePrioritySchools()),type:"priority schools",description:"priority schools per training"},null,8,["value","average"])):(r(),v(a,{key:7}))])}var Pe=w(Ne,[["render",De]]);const qe=m({components:{apexchart:F},setup(){const e=b({chart:{id:"engagement-levels",stacked:!0,stackType:"100%"},plotOptions:{bar:{horizontal:!0}},theme:{palette:"palette3"},legend:{position:"top"},xaxis:{labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{show:!1},colors:["#2b63eb","#113795","#07205b"]}),s=b([{name:"Engaged (1 module)",data:[0]},{name:"Sustained (2 modules)",data:[0]},{name:"Embedded (3+ modules)",data:[0]}]),d=S(),{loading:p,attendees:c}=x(d);return j(()=>{var t;if(c.value){let o=[];for(const a in c.value)for(const l in c.value[a])o[""+c.value[a][l].days]=((t=o[""+c.value[a][l].days])!=null?t:0)+1;for(const a in Object.keys(o)){const l=parseInt(Object.keys(o)[a])<3?parseInt(Object.keys(o)[a]):2;s.value[l].data[0]=parseInt(s.value[l].data[0])+parseInt(o[Object.keys(o)[a]])}}}),{loading:p,chartOptions:e,series:s,attendees:c}}}),He={class:"bg-white p-4 rounded-xl mb-4"},Me=n("p",{class:"font-bold text-lg"},"Engagement level",-1),Re={key:1,class:"text-xl w-full inline-block text-center text-gray-400"},Ue={key:2,class:"block relative flex items-center justify-center w-full",style:{height:"150px"}},Le=n("svg",{class:"animate-spin ml-2 mt-1 h-8 w-8 text-gray-400 inline-block -mt-px",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",style:{"margin-bottom":"0!important"}},[n("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),n("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),Ye=[Le];function Ge(e,s,d,p,c,t){var a,l,i;const o=f("apexchart");return r(),h("article",He,[Me,!e.loading&&((a=e.attendees)==null?void 0:a.length)>0?(r(),v(o,{key:0,height:"150",type:"bar",options:e.chartOptions,series:e.series},null,8,["options","series"])):$("",!0),!e.loading&&((l=e.attendees)==null?void 0:l.length)===0?(r(),h("p",Re,"There is no data to preview")):$("",!0),n("span",{class:I(["block w-full text-center py-2",e.loading||((i=e.attendees)==null?void 0:i.length)===0?"opacity-0":""])},"Showing the split of engagement levels across all events in this time period",2),e.loading?(r(),h("span",Ue,Ye)):$("",!0)])}var Je=w(qe,[["render",Ge]]);const Ke=m({components:{apexchart:F},setup(e){const s=b({chart:{id:"follow-on-support"},plotOptions:{bar:{horizontal:!0,height:"10%"}},theme:{palette:"palette3"},legend:{position:"top"},xaxis:{categories:[]},yaxis:{labels:{style:{fontSize:"14px",fontFamily:'system-ui,BlinkMacSystemFont,-apple-system,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif'}}},colors:["#2b63eb","#113795","#07205b"]}),d=b([{name:"Follow on support",data:[]}]),p=S(),{loading:c,followOnSupport:t,followOnSupportOptions:o}=x(p);return j(()=>{var a,l;if(t.value){let i=[],g=[];for(const u in t.value)for(const y in t.value[u])i[""+t.value[u][y].optionId]=((a=i[""+t.value[u][y].optionId])!=null?a:0)+1;for(const u in i)g.push((l=o.value.find(y=>y.id==i[u]))==null?void 0:l.name);s.value.xaxis.categories=g,d.value[0].data=[],Object.values(i).forEach((u,y)=>{d.value[0].data.push(u)})}}),{chartOptions:s,series:d,loading:c,followOnSupport:t}}}),Qe={class:"bg-white p-4 rounded-xl mb-4"},We=n("p",{class:"font-bold text-lg"},"Follow on support",-1),Xe={key:1,class:"text-xl w-full inline-block text-center text-gray-400 flex items-center justify-center w-full block",style:{height:"800px"}},Ze=n("span",null,"There is no data to preview",-1),et=[Ze],tt={key:2,class:"block relative flex items-center justify-center w-full",style:{height:"800px"}},st=n("svg",{class:"animate-spin ml-2 mt-1 h-8 w-8 text-gray-400 inline-block -mt-px",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",style:{"margin-bottom":"0!important"}},[n("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),n("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),ot=[st];function at(e,s,d,p,c,t){var a,l,i;const o=f("apexchart");return r(),h("article",Qe,[We,!e.loading&&((a=e.followOnSupport)==null?void 0:a.length)>0?(r(),v(o,{key:0,height:"800px",type:"bar",options:e.chartOptions,series:e.series},null,8,["options","series"])):$("",!0),!e.loading&&((l=e.followOnSupport)==null?void 0:l.length)===0?(r(),h("p",Xe,et)):$("",!0),n("span",{class:I(["block w-full text-center py-2",e.loading||((i=e.followOnSupport)==null?void 0:i.length)===0?"opacity-0":""])},"Showing what types of follow on support have been offered.",2),e.loading?(r(),h("span",tt,ot)):$("",!0)])}var nt=w(Ke,[["render",at]]);const lt=m({components:{"stats-completion":fe,"stats-figures":Pe,"stats-levels":Je,"stats-support":nt},props:{site:{type:String,required:!0}},setup(e){const s=S();s.site=e.site=="*"?2:e.site,s.fetchEvents(e.ids)}});function rt(e,s,d,p,c,t){const o=f("stats-figures"),a=f("stats-levels"),l=f("stats-support"),i=f("stats-completion");return r(),h(M,null,[C(o),C(a),C(l),C(i)],64)}var it=w(lt,[["render",rt]]);const ct=m({components:{"header-dashboard":re,"stats-dashboard":it}}),dt=async()=>{const e=R(ct);return e.use(U()),e.mount("#dashboard")};dt().then(e=>{});
//# sourceMappingURL=dashboard.5bbf0763.js.map

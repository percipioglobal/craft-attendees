/* empty css            */import{A as M,B as P,d as _,s as S,f as V,I as q,c as m,o as c,p as L,r as y,w as D,l as $,a as i,t as w,m as C,k as N,J as z,z as b,b as k,n as T,F as Y,G as H,H as U}from"./vendor.ddcec68c.js";import{_ as x,u as R}from"./plugin-vue_export-helper.70ac9843.js";var F,B;const G=(B=(F=window==null?void 0:window.Attendee)==null?void 0:F.cpUrl)!=null?B:"https://researchschool.org.uk/cp",O=M("trainings",{state:()=>({events:null,attendees:null,followOnSupport:null,followOnSupportOptions:null,period:3,site:"main",loading:!1}),actions:{fetchEvents(){const e=this;this.loading=!0;const t=this.site,d=this.period;P({method:"get",url:`${G}/craft-attendees/dashboard/events/${t}/${d}`}).then(function(o){var n,p,s,l;e.loading=!1,e.events=(n=o==null?void 0:o.data)==null?void 0:n.events,e.attendees=(p=o==null?void 0:o.data)==null?void 0:p.attendees,e.followOnSupport=(s=o==null?void 0:o.data)==null?void 0:s.follow_on_support,e.followOnSupportOptions=(l=o==null?void 0:o.data)==null?void 0:l.follow_on_support_options})}}}),J=_({setup(){const e=O(),{loading:t,period:d}=S(e);return{loading:t,period:d,handlePeriodChanged:n=>{e.period=parseInt(n.currentTarget.value),e.fetchEvents()}}}}),K=["disabled"],Q=L('<option value="2022">Academic Year (2021/22)</option><option value="2021">Academic Year (2020/21)</option><option value="2020">Academic Year (2019/20)</option><option value="3">Last 3 months</option><option value="6">Last 6 months</option>',5),W=[Q];function X(e,t,d,o,n,p){return V((c(),m("select",{name:"period",class:"block h-10 px-1 rounded-md bg-gray-300 border-gray-300","onUpdate:modelValue":t[0]||(t[0]=s=>e.period=s),disabled:e.loading,onChange:t[1]||(t[1]=(...s)=>e.handlePeriodChanged&&e.handlePeriodChanged(...s))},W,40,K)),[[q,e.period]])}var Z=x(J,[["render",X]]);const ee=_({components:{dropdown:Z},setup(){const e=O(),{period:t}=S(e),d=y("-"),o=y("-");return D(()=>{if(t.value)if(t.value<12){let n=new Date;o.value=n.getDate()+" "+n.toLocaleString("default",{month:"long"})+" "+n.getFullYear(),n.setMonth(n.getMonth()-t.value),d.value=n.getDate()+" "+n.toLocaleString("default",{month:"long"})+" "+n.getFullYear()}else{let n=new Date(`31 july ${t.value}`),p=new Date(`01 september ${t.value-1}`);o.value=n.getDate()+" "+n.toLocaleString("default",{month:"long"})+" "+n.getFullYear(),d.value=p.getDate()+" "+p.toLocaleString("default",{month:"long"})+" "+p.getFullYear()}}),{start:d,end:o}}}),te={class:"flex w-full sticky z-20 bg-gray-100 bg-opacity-70 py-4 backdrop-blur",style:{top:"50px"}},oe={class:"text-xl font-bold inline-block flex-grow",style:{"margin-bottom":"0!important"}},se=N("Showing data from "),ne=N(" to "),ae={style:{"margin-top":"0!important"}};function le(e,t,d,o,n,p){const s=$("dropdown");return c(),m("div",te,[i("p",oe,[se,i("strong",null,w(e.start),1),ne,i("strong",null,w(e.end),1)]),i("div",ae,[C(s)])])}var re=x(ee,[["render",le]]);const ie=_({components:{apexchart:z},setup(){const e=y({chart:{id:"engagement-levels",stacked:!0,stackType:"100%"},plotOptions:{bar:{horizontal:!0}},theme:{palette:"palette3"},legend:{show:!1},xaxis:{labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{show:!1},colors:["#2b63eb","#113795"]}),t=y([{name:"Attendees",data:[0]},{name:"Attendees (100% verified)",data:[0]}]),d=R(),{loading:o,events:n,attendees:p}=S(d),s=y(0),l=y(0),g=y(0);return D(()=>{if(p.value){const v=p.value.reduce(function(h,r){return h[r.eventId]=h[r.eventId]||[],h[r.eventId].push(r),h},Object.create(null));s.value=Object.keys(v).length,Object.values(v).forEach((h,r)=>{l.value=l.value+h.length;let u=!0;for(const a in h)h[a].approved!=1&&(u=!1);u&&(g.value=g.value+1)}),t.value[0].data[0]=s.value,t.value[1].data[0]=g.value}}),{loading:o,chartOptions:e,series:t,events:n,allAttendees:s,totalAttendeesAreApproved:g,attendees:p}}}),ce={class:"bg-white p-4 rounded-xl mb-4"},de=i("p",{class:"font-bold text-lg"},"Engagement Data Completion",-1),pe={key:1,class:"text-xl w-full inline-block text-center text-gray-400"},ue=N(" total training events, "),he={key:2,class:"block relative flex items-center justify-center w-full",style:{height:"150px"}},ge=i("svg",{class:"animate-spin ml-2 mt-1 h-8 w-8 text-gray-400 inline-block -mt-px",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",style:{"margin-bottom":"0!important"}},[i("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),i("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),ve=[ge];function me(e,t,d,o,n,p){var l,g,v,h,r;const s=$("apexchart");return c(),m("article",ce,[de,!e.loading&&((l=e.attendees)==null?void 0:l.length)>0?(c(),b(s,{key:0,height:"150",type:"bar",options:e.chartOptions,series:e.series},null,8,["options","series"])):k("",!0),!e.loading&&((g=e.attendees)==null?void 0:g.length)===0?(c(),m("p",pe,"There is no data to preview")):k("",!0),i("span",{class:T(["block w-full text-center py-2",e.loading||((v=e.attendees)==null?void 0:v.length)===0?"opacity-0":""])},[i("strong",null,w((h=e.events)==null?void 0:h.length),1),ue,i("strong",null,w(e.allAttendees),1),N(" have attendees and ("+w(((r=e.events)==null?void 0:r.length)/100*e.totalAttendeesAreApproved)+"%) are verified.",1)],2),e.loading?(c(),m("span",he,ve)):k("",!0)])}var fe=x(ie,[["render",me]]);const ye=_({props:{value:{type:Number,required:!0},type:{type:String,required:!0},average:{type:Number,required:!0},description:{type:String,required:!0}}}),be={class:"bg-white rounded-xl p-4"},_e={class:"flex items-end pb-2",style:{"align-items":"end"}},$e={class:"text-6xl block text-blue-600",style:{"margin-bottom":"0!important"}},we={class:"block pb-1",style:{"margin-bottom":"0!important"}},ke={class:"block pb-1 text-xs"},xe=N("Avg. ");function Se(e,t,d,o,n,p){return c(),m("article",be,[i("span",_e,[i("span",$e,w(e.value),1),i("span",we,w(e.type),1)]),i("span",ke,[xe,i("strong",null,w(e.average),1),N(" "+w(e.description),1)])])}var Oe=x(ye,[["render",Se]]);const Ae=_({setup(){const e=O(),{loading:t}=S(e);return{loading:t}}}),je={class:"bg-white rounded-xl p-4"},Ne={key:0},Ce=i("span",{class:"animate-pulse flex items-end pb-2",style:{"align-items":"end"}},[i("span",{class:"text-6xl block text-blue-600 bg-blue-600 bg-opacity-10 rounded-md",style:{"margin-bottom":"0!important"}},"\xA0\xA0\xA0\xA0\xA0\xA0"),i("span",{class:"block pb-1 bg-gray-200 bg-opacity-50 flex-grow rounded-md",style:{"margin-bottom":"0!important"}},"\xA0")],-1),Ie=i("span",{class:"animate-pulse block pb-1 text-xs bg-gray-200 bg-opacity-50 rounded-md"},"\xA0",-1),Ee=[Ce,Ie],De={key:1,class:"flex items-center justify-center w-full h-full font-bold"};function ze(e,t,d,o,n,p){return c(),m("article",je,[e.loading?(c(),m("div",Ne,Ee)):(c(),m("div",De," There is no data to preview "))])}var Te=x(Ae,[["render",ze]]);const Fe=_({components:{stat:Oe,"stat-empty":Te},setup(){const e=O(),{loading:t,events:d,attendees:o,period:n}=S(e);return{loading:t,events:d,attendees:o,schools:()=>{const r=o.value.reduce(function(u,a){return u[a.orgName]=u[a.orgName]||[],u[a.orgName].push(a),u},Object.create(null));return Object.keys(r).length},priority:()=>{const r=o.value.reduce(function(u,a){return u[a.priority]=u[a.priority]||[],u[a.priority].push(a),u},Object.create(null));return isNaN(Object.keys(r).length)?0:Object.keys(r).length},averageEvents:()=>Math.ceil(d.value.length/n.value),averageAttendees:()=>{const r=o.value.reduce(function(a,f){return a[f.eventId]=a[f.eventId]||[],a[f.eventId].push(f),a},Object.create(null));let u=Object.values(r).map(a=>a.length);return u=Math.ceil(u.reduce((a,f)=>a+f,0)/u.length),isNaN(u)?0:u},averageSchools:()=>{var f;const r=o.value.reduce(function(A,j){return A[j.eventId]=A[j.eventId]||[],A[j.eventId].push(j),A},Object.create(null));let u=0;for(const A in r){const j=r[A].reduce(function(I,E){return I[E.orgName]=I[E.orgName]||[],I[E.orgName].push(E),I},Object.create(null));u+=Object.keys(j).length}const a=Math.ceil(u/((f=Object.keys(r))==null?void 0:f.length));return isNaN(a)?0:a},averagePrioritySchools:()=>{let r=o.value.filter(a=>a.priority===1);r=r.reduce(function(a,f){return a[f.eventId]=a[f.eventId]||[],a[f.eventId].push(f),a},Object.create(null));let u=Object.values(r).map(a=>a.length);return u=Math.ceil(u.reduce((a,f)=>a+f,0)/u.length),isNaN(u)?0:u}}}}),Be={class:"grid grid-cols-2 xl:grid-cols-4 gap-4"};function Me(e,t,d,o,n,p){const s=$("stat"),l=$("stat-empty");return c(),m("div",Be,[e.events&&!e.loading?(c(),b(s,{key:0,value:e.events.length,average:e.averageEvents(),type:"events",description:"trainings per month"},null,8,["value","average"])):(c(),b(l,{key:1})),e.attendees&&!e.loading?(c(),b(s,{key:2,value:e.attendees.length,average:e.averageAttendees(),type:"attendees",description:"attendees per training"},null,8,["value","average"])):(c(),b(l,{key:3})),e.attendees&&!e.loading?(c(),b(s,{key:4,value:e.schools(),average:e.averageSchools(),type:"schools",description:"schools per training"},null,8,["value","average"])):(c(),b(l,{key:5})),e.attendees&&!e.loading?(c(),b(s,{key:6,value:e.priority(),average:e.averagePrioritySchools(),type:"priority schools",description:"priority schools per training"},null,8,["value","average"])):(c(),b(l,{key:7}))])}var Pe=x(Fe,[["render",Me]]);const Ve=_({components:{apexchart:z},setup(){const e=y({chart:{id:"engagement-levels",stacked:!0,stackType:"100%"},plotOptions:{bar:{horizontal:!0}},theme:{palette:"palette3"},legend:{position:"top"},xaxis:{labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{show:!1},colors:["#2b63eb","#113795","#07205b"]}),t=y([{name:"Engaged (1 module)",data:[0]},{name:"Sustained (2 modules)",data:[0]},{name:"Embedded (3+ modules)",data:[0]}]),d=O(),{loading:o,attendees:n}=S(d);return D(()=>{if(n.value){const p=n.value.reduce(function(s,l){return s[l.days]=s[l.days]||[],s[l.days].push(l),s},Object.create(null));for(const s in Object.keys(p)){const l=s<3?s:2;t.value[l].data[0]=parseInt(t.value[l].data[0])+Object.values(p)[s].length}}}),{loading:o,chartOptions:e,series:t,attendees:n}}}),qe={class:"bg-white p-4 rounded-xl mb-4"},Le=i("p",{class:"font-bold text-lg"},"Engagement level",-1),Ye={key:1,class:"text-xl w-full inline-block text-center text-gray-400"},He={key:2,class:"block relative flex items-center justify-center w-full",style:{height:"150px"}},Ue=i("svg",{class:"animate-spin ml-2 mt-1 h-8 w-8 text-gray-400 inline-block -mt-px",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",style:{"margin-bottom":"0!important"}},[i("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),i("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),Re=[Ue];function Ge(e,t,d,o,n,p){var l,g,v;const s=$("apexchart");return c(),m("article",qe,[Le,!e.loading&&((l=e.attendees)==null?void 0:l.length)>0?(c(),b(s,{key:0,height:"150",type:"bar",options:e.chartOptions,series:e.series},null,8,["options","series"])):k("",!0),!e.loading&&((g=e.attendees)==null?void 0:g.length)===0?(c(),m("p",Ye,"There is no data to preview")):k("",!0),i("span",{class:T(["block w-full text-center py-2",e.loading||((v=e.attendees)==null?void 0:v.length)===0?"opacity-0":""])},"Showing the split of engagement levels across all events in this time period",2),e.loading?(c(),m("span",He,Re)):k("",!0)])}var Je=x(Ve,[["render",Ge]]);const Ke=_({components:{apexchart:z},setup(e){const t=y({chart:{id:"follow-on-support"},plotOptions:{bar:{horizontal:!0,height:"10%"}},theme:{palette:"palette3"},legend:{position:"top"},xaxis:{categories:[]},yaxis:{labels:{style:{fontSize:"14px",fontFamily:'system-ui,BlinkMacSystemFont,-apple-system,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif'}}},colors:["#2b63eb","#113795","#07205b"]}),d=y([{name:"Follow on support",data:[]}]),o=O(),{loading:n,followOnSupport:p,followOnSupportOptions:s}=S(o);return D(()=>{var l;if(p.value){const g=p.value.reduce(function(h,r){return h[r.optionId]=h[r.optionId]||[],h[r.optionId].push(r),h},Object.create(null));let v=[];for(const h in g)v.push((l=s.value.find(r=>r.id==h))==null?void 0:l.name);t.value.xaxis.categories=v,d.value[0].data=[],Object.values(g).forEach((h,r)=>{d.value[0].data.push(h.length)})}}),{chartOptions:t,series:d,loading:n,followOnSupport:p}}}),Qe={class:"bg-white p-4 rounded-xl mb-4"},We=i("p",{class:"font-bold text-lg"},"Follow on support",-1),Xe={key:1,class:"text-xl w-full inline-block text-center text-gray-400 flex items-center justify-center w-full block",style:{height:"800px"}},Ze=i("span",null,"There is no data to preview",-1),et=[Ze],tt={key:2,class:"block relative flex items-center justify-center w-full",style:{height:"800px"}},ot=i("svg",{class:"animate-spin ml-2 mt-1 h-8 w-8 text-gray-400 inline-block -mt-px",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",style:{"margin-bottom":"0!important"}},[i("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),i("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),st=[ot];function nt(e,t,d,o,n,p){var l,g,v;const s=$("apexchart");return c(),m("article",Qe,[We,!e.loading&&((l=e.followOnSupport)==null?void 0:l.length)>0?(c(),b(s,{key:0,height:"800px",type:"bar",options:e.chartOptions,series:e.series},null,8,["options","series"])):k("",!0),!e.loading&&((g=e.followOnSupport)==null?void 0:g.length)===0?(c(),m("p",Xe,et)):k("",!0),i("span",{class:T(["block w-full text-center py-2",e.loading||((v=e.followOnSupport)==null?void 0:v.length)===0?"opacity-0":""])},"Showing what types of follow on support have been offered.",2),e.loading?(c(),m("span",tt,st)):k("",!0)])}var at=x(Ke,[["render",nt]]);const lt=_({components:{"stats-completion":fe,"stats-figures":Pe,"stats-levels":Je,"stats-support":at},props:{site:{type:String,required:!0}},setup(e){const t=O();S(t),t.site=e.site=="*"?2:e.site,t.fetchEvents()}});function rt(e,t,d,o,n,p){const s=$("stats-figures"),l=$("stats-levels"),g=$("stats-support"),v=$("stats-completion");return c(),m(Y,null,[C(s),C(l),C(g),C(v)],64)}var it=x(lt,[["render",rt]]);const ct=_({components:{"header-dashboard":re,"stats-dashboard":it}}),dt=async()=>{const e=H(ct);return e.use(U()),e.mount("#dashboard")};dt().then(e=>{});
//# sourceMappingURL=dashboard.e4ea3e5f.js.map

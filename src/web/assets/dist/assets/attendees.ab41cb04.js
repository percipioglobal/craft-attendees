var ke=Object.defineProperty;var be=Object.getOwnPropertySymbols;var we=Object.prototype.hasOwnProperty,$e=Object.prototype.propertyIsEnumerable;var me=(e,t,l)=>t in e?ke(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,le=(e,t)=>{for(var l in t||(t={}))we.call(t,l)&&me(e,l,t[l]);if(be)for(var l of be(t))$e.call(t,l)&&me(e,l,t[l]);return e};import{d as xe,a as ae,b as C,s as N,c as u,t as $,o as i,r as g,w as X,e as o,n as x,f as _e,g as ve,v as Se,h as de,i as ie,j as _,k as Ae,F as re,l as ge,m as F,p as R,q as Z,u as fe,x as ye,y as Ce,z as Fe}from"./vendor.cc18e8c4.js";const q=xe("attendees",{state:()=>({attendees:null,totalAttendees:null,attendeeInput:null,attendeeFormErrors:!1,attendeeSuccess:!1,showForm:!1,loading:!1,loadingApi:!1,schools:null}),actions:{async fetchSchools(e){var t;if(e){this.loadingApi=!0;const n=await ae.create({baseURL:`https://api.v2.metaseed.io/schools/?mode=legacy&query=${e}`,timeout:3e3}).get("");(n==null?void 0:n.data)?(this.schools=(t=n.data)==null?void 0:t.suggestions,this.loadingApi=!1):this.loadingApi=!1}},deleteAttendee(e){const t=this;this.loading=!0,ae({method:"post",url:"/admin/actions/craft-attendees/training/delete",data:e}).then(function(l){t.loading=!1,t.attendees=t.attendees.filter(n=>n.id!=e.attendeeId)})},submitAttendee(e){let t={};if(e instanceof FormData)for(var l of e.entries())t[l[0]]=l[1];else t=e;this.attendeeFormErrors=!1,this.loading=!0,this.attendeeSuccess=!1,this.attendeeInput=t;const n=this;ae({method:"post",url:"/admin/actions/craft-attendees/training/save",data:e}).then(function(r){var p;if(!r.data.success)n.attendeeFormErrors=r.data.errors,n.loading=!1,n.attendeeSuccess=!1;else{let a=n.attendees.filter(h=>{var c,v;return h.id==((v=(c=r==null?void 0:r.data)==null?void 0:c.attendee)==null?void 0:v.id)});const d=n.attendees.findIndex(h=>{var c,v;return h.id==((v=(c=r==null?void 0:r.data)==null?void 0:c.attendee)==null?void 0:v.id)});a.length>0?(a=a[0],a.name=t==null?void 0:t.name,a.orgName=t==null?void 0:t.orgName,a.postCode=t==null?void 0:t.postCode,a.days=t==null?void 0:t.days,a.email=t==null?void 0:t.email,a.newsletter=t==null?void 0:t.newsletter,a.approved=t==null?void 0:t.approved,a.jobRole=t==null?void 0:t.jobRole,n.attendees[d]=a):n.attendees.unshift((p=r==null?void 0:r.data)==null?void 0:p.attendee),n.loading=!1,n.attendeeFormErrors=!1,n.attendeeSuccess=!0,n.attendeeInput=null}})},fetchAttendees(e,t,l){const n=this;this.loading=!0,console.log("limit",t),ae({method:"get",url:`/admin/craft-attendees/trainings/attendees/${e}/${t}/${l}`}).then(function(r){var p,a,d,h;n.loading=!1,n.totalAttendees=parseInt((a=(p=r==null?void 0:r.data)==null?void 0:p.meta)==null?void 0:a.total),n.attendees=n.attendees?n.attendees.concat((d=r==null?void 0:r.data)==null?void 0:d.attendees):(h=r==null?void 0:r.data)==null?void 0:h.attendees})},setShowFrom(e){this.attendeeFormErrors=!1,this.showForm=e},resetForm(){this.loading=!1,this.attendeeFormErrors=!1,this.attendeeInput=null},clearSchools(){this.schools=null}}});var D=(e,t)=>{const l=e.__vccOpts||e;for(const[n,r]of t)l[n]=r;return l};const Ee=C({setup(){const e=q(),{showForm:t}=N(e);return{showForm:t,toggle:()=>{e.setShowFrom(!0)}}}});function Ie(e,t,l,n,r,p){return i(),u("button",{class:"bg-emerald-300 text-emerald-800 font-bold py-2 px-3 text-sm rounded-lg cursor-pointer",onClick:t[0]||(t[0]=(...a)=>e.toggle&&e.toggle(...a))},$(e.showForm?"Close form":"Add attendee"),1)}var De=D(Ee,[["render",Ie]]);const Te=C({props:{label:{type:String,required:!1},name:{type:String,required:!0},checked:{default:0}},setup(e){const t=g(0);return X(()=>{t.value=e.checked==0?0:1}),{toggle:()=>{t.value=t.value==0?1:0},checkedValue:t}}}),Ne={class:"inline-block relative"},qe=["name","value","checked"],Re={class:"peer-focus:ring-2 peer-focus:ring-opacity-50 peer-focus:ring-blue-700 peer-focus:shadow-lg outline-none rounded-full inline-block cursor-pointer"};function Ve(e,t,l,n,r,p){return i(),u("div",Ne,[o("input",{name:e.name,type:"checkbox",class:"peer sr-only",value:e.checkedValue,checked:e.checkedValue==1,onClick:t[0]||(t[0]=(...a)=>e.toggle&&e.toggle(...a))},null,8,qe),o("div",Re,[o("div",{class:x(["block h-6 rounded-full w-10 cursor-pointer bg-opacity-100",e.checkedValue==1?"bg-emerald-100":"bg-indigo-100"])},null,2),o("div",{class:x(["absolute w-4 h-4 transition rounded-full left-1 top-1 flex items-center not-sr-only",e.checkedValue==1?"bg-emerald-700 transform translate-x-full":"bg-gray-400"])},null,2)])])}var ze=D(Te,[["render",Ve]]);const Me=C({props:{values:{type:Object,default:{}}},emits:["schoolSelect"],setup(e,{emit:t}){var z,M,P,U,H,B,L,j,K,Y,G,J;const l=g(null),n=q(),r=g(Math.floor(Math.random()*100)+Date.now()),{attendeeInput:p,attendeeFormErrors:a,schools:d,loadingApi:h}=N(n),c=g((U=(P=(z=p.value)==null?void 0:z.orgName)!=null?P:(M=e.values)==null?void 0:M.orgName)!=null?U:""),v=g((j=(L=(H=p.value)==null?void 0:H.orgUrn)!=null?L:(B=e.values)==null?void 0:B.orgUrn)!=null?j:""),s=g((J=(G=(K=p.value)==null?void 0:K.postCode)!=null?G:(Y=e.values)==null?void 0:Y.postCode)!=null?J:""),S=g(null),w=g(!1),b=g(0),f=g(!0),m=y=>{var k,A,E,I;c.value=y.currentTarget.textContent,v.value=(A=(k=y.currentTarget)==null?void 0:k.dataset)==null?void 0:A.urn,s.value=(I=(E=y.currentTarget)==null?void 0:E.dataset)==null?void 0:I.postcode,f.value=!1,t("schoolSelect",c.value,v.value,s.value),w.value=!1,n.clearSchools()},T=()=>{f.value=!0,c.value.length>2&&(w.value=!0,n.fetchSchools(c.value))},O=y=>{var k;((k=c.value)==null?void 0:k.length)===0&&n.clearSchools(),w.value=y},ee=()=>{S.value&&clearTimeout(S.value),S.value=setTimeout(T,200)},te=()=>{var y,k;b.value=b.value<((y=d.value)==null?void 0:y.length)-1?b.value+1:((k=d.value)==null?void 0:k.length)-1,l.value.querySelectorAll("li")[b.value].scrollIntoView({block:"nearest"})},oe=()=>{b.value=b.value>0?b.value-1:0,l.value.querySelectorAll("li")[b.value].scrollIntoView({block:"nearest"})},se=()=>{var k,A,E,I,Q;const y={currentTarget:{textContent:(k=d.value[b.value])==null?void 0:k.value,dataset:{urn:(E=(A=d.value[b.value])==null?void 0:A.data)==null?void 0:E.urn,postcode:(Q=(I=d.value[b.value])==null?void 0:I.data)==null?void 0:Q.postcode}}};m(y)},ne=()=>{var y;c.value=null,((y=v.value)==null?void 0:y.length)>0&&V()};_e(c,(y,k)=>{var A;y!==k&&((A=v.value)==null?void 0:A.length)>0&&f.value&&V(),f.value=!0});const V=()=>{v.value=null,s.value=null,t("schoolSelect",c.value,v.value,s.value),w.value=!1,n.clearSchools()};return{attendeeInput:p,attendeeFormErrors:a,school:c,schools:d,urn:v,uniqueId:r,postcode:s,showDropdown:w,schoolDropdown:l,currentSelectionIndex:b,clearResults:f,loadingApi:h,delay:ee,handleSchoolSelect:m,handleSchoolInput:T,handleFocus:O,handleClear:ne,onArrowDown:te,onArrowUp:oe,selectCurrentSelection:se}}}),Pe=["value"],Ue={class:"block mb-6"},He=o("span",{class:"text-xs font-bold text-gray-400 block mb-1"},[F("School / Organisation "),o("span",{class:"text-blue-500"},"*")],-1),Be={class:"w-full relative"},Le=["aria-owns"],je=["aria-expanded","id"],Ke=["data-postcode","data-urn"],Ye={key:1,class:"p-2 block"},Ge={key:1,class:"p-2 pt-3 inline-block"},Je=o("svg",{class:"animate-spin mr-1 h-4 w-4 text-emerald-800",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),Qe=[Je],We={class:"block mb-6"},Xe=o("span",{class:"text-xs font-bold text-gray-400 block mb-1"},[F("Post code "),o("span",{class:"text-blue-500"},"*")],-1),Ze=["value"];function Oe(e,t,l,n,r,p){var a,d,h,c,v;return i(),u(re,null,[o("input",{type:"hidden",name:"orgUrn",value:(a=e.urn)!=null?a:""},null,8,Pe),o("label",Ue,[He,o("div",Be,[ve(o("input",{name:"orgName","onUpdate:modelValue":t[0]||(t[0]=s=>e.school=s),onInput:t[1]||(t[1]=(...s)=>e.delay&&e.delay(...s)),onFocus:t[2]||(t[2]=s=>e.handleFocus(!0)),onBlur:t[3]||(t[3]=s=>e.handleFocus(!1)),onKeydown:[t[4]||(t[4]=de(ie((...s)=>e.onArrowDown&&e.onArrowDown(...s),["prevent"]),["down"])),t[5]||(t[5]=de(ie((...s)=>e.onArrowUp&&e.onArrowUp(...s),["prevent"]),["up"])),t[6]||(t[6]=de(ie((...s)=>e.selectCurrentSelection&&e.selectCurrentSelection(...s),["prevent"]),["enter"]))],class:x(["block peer w-full px-2 py-2 text-sm text-gray-600 box-border bg-gray-100 rounded-lg pr-7",((d=e.attendeeFormErrors)==null?void 0:d.orgName)?"border-solid border-red-300":"border-solid border-gray-100"]),placeholder:"Search for a school or organisation","aria-owns":`metaseed-list-${e.uniqueId}`,"aria-autocomplete":"list",role:"combobox"},null,42,Le),[[Se,e.school]]),((h=e.school)==null?void 0:h.length)>3?(i(),u("span",{key:0,onClick:t[7]||(t[7]=(...s)=>e.handleClear&&e.handleClear(...s)),class:"text-blue-800 bg-gray-100 block w-6 text-center flex items-center justify-center h-8 absolute right-0 top-1 cursor:pointer"},"\u2715")):_("",!0),ve(o("ul",{class:"absolute left-0 top-full mt-1 w-full max-h-52 overflow-scroll z-10 bg-gray-100 rounded-lg shadow-xl",ref:"schoolDropdown","aria-expanded":e.showDropdown,role:"listbox",id:`metaseed-list-${e.uniqueId}`},[e.loadingApi?_("",!0):(i(!0),u(re,{key:0},ge(e.schools,(s,S)=>{var w,b,f;return i(),u("li",{key:(w=s==null?void 0:s.data)==null?void 0:w.urn,role:"option"},[(s==null?void 0:s.data)?(i(),u("span",{key:0,onMousedown:t[8]||(t[8]=(...m)=>e.handleSchoolSelect&&e.handleSchoolSelect(...m)),onTouch:t[9]||(t[9]=(...m)=>e.handleSchoolSelect&&e.handleSchoolSelect(...m)),role:"button","data-postcode":(b=s==null?void 0:s.data)==null?void 0:b.postcode,"data-urn":(f=s==null?void 0:s.data)==null?void 0:f.urn,class:x(["p-2 pointer-all hover:bg-blue-600 hover:text-white focus:bg-blue-600 text-sm block",e.currentSelectionIndex===S?"bg-blue-600 text-white":""])},$(s.value),43,Ke)):(i(),u("span",Ye," There's no school that matches the input "))])}),128)),e.loadingApi?(i(),u("li",Ge,Qe)):_("",!0)],8,je),[[Ae,e.showDropdown]])])]),o("label",We,[Xe,o("input",{name:"postCode",value:e.postcode,class:x(["block w-full px-2 py-2 text-sm text-gray-600 appearance-none box-border bg-gray-100 rounded-lg",((c=e.urn)==null?void 0:c.length)>0?"text-gray-400 cursor-not-allowed":"",((v=e.attendeeFormErrors)==null?void 0:v.postCode)?"border-solid border-red-300":"border-solid border-gray-100"]),placeholder:"Enter a post code"},null,10,Ze)])],64)}var et=D(Me,[["render",Oe]]);const tt=C({components:{"input-school":et,"input-switch":ze},props:{csrf:{type:String,required:!0},event:{type:String,required:!0},title:{type:String},values:{type:Object,default:{}}},setup(e,{emit:t}){const l=g(null);g(null),g(null);const n=g(null),r=q(),{attendeeInput:p,attendeeFormErrors:a,loading:d,showForm:h,resetAttendeeInput:c}=N(r),v=b=>{if(b.preventDefault(),l.value){let m=new FormData(l.value),T={};for(var f of m.entries())T[f[0]]=f[1];r.submitAttendee(m),t("submitForm")}},s=()=>{r.resetForm(),t("hideForm")},S=b=>{b.keyCode===27&&s()},w=(b,f,m)=>{n.value=f};return X(()=>{var b,f;(b=l.value)==null||b.querySelectorAll('input[name="orgName"]')[0].focus(),h.value&&((f=l.value)==null||f.querySelectorAll('input[name="orgName"]')[0].focus())}),{form:l,attendeeInput:p,attendeeFormErrors:a,loading:d,showForm:h,urn:n,handleSubmit:v,hideForm:s,keyup:S,handleSchoolSelect:w}}}),ot=o("input",{type:"hidden",name:"action",value:"actions/craft-attendees/training/save"},null,-1),st=["value"],nt=["value"],lt=["value"],at={class:"block mb-6"},rt=o("span",{class:"text-xs font-bold text-gray-400 block mb-1"},[F("Name of attendee "),o("span",{class:"text-blue-500"},"*")],-1),dt=["value"],it={class:"block mb-6"},ut=o("span",{class:"text-xs font-bold text-gray-400 block mb-1"},[F("Attendee's job role "),o("span",{class:"text-blue-500"},"*")],-1),ct=["value"],pt=fe('<option value="" default disabled class="text-gray-400">Select the job role of the attendee</option><option value="na">Not Applicable</option><option value="support">Support Staff</option><option value="leader-middle">Middle leader</option><option value="leader">Leadership</option><option value="teacher">Teacher</option>',6),ht=[pt],bt={class:"block mb-6"},mt=o("span",{class:"text-xs font-bold text-gray-400 block mb-1"},[F("Email address of attendee "),o("span",{class:"text-blue-500"},"*")],-1),vt=["value"],gt={class:"block mb-6"},ft=o("span",{class:"text-xs font-bold text-gray-400 block mb-1"},[F("Attending days "),o("span",{class:"text-blue-500"},"*")],-1),yt=["value"],kt=fe('<option default value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option>',10),wt=[kt],$t={class:"block mb-6"},xt=o("span",{class:"text-xs font-bold text-gray-400 block mb-1"},"Subscribe for the newsletter",-1),_t={class:"block mb-6"},St=o("span",{class:"text-xs font-bold text-gray-400 block mb-1"},"School is approved",-1),At={key:0,class:"text-blue-600 text-xs"},Ct=F("This school is a verified school. Visit the "),Ft=["href"],Et={class:"mb-6"},It=o("span",{class:"text-xs font-bold text-gray-400 block mb-2"},"Actions",-1),Dt={class:"bg-emerald-300 text-emerald-800 font-bold py-2 px-3 text-sm rounded-lg cursor-pointer inline-block"},Tt={key:0,class:"animate-spin -ml-1 mr-1 h-3 w-3 text-emerald-800",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Nt=o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),qt=o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),Rt=[Nt,qt],Vt=F(" Save "),zt=o("div",null,null,-1);function Mt(e,t,l,n,r,p){var h,c,v,s,S,w,b,f,m,T,O,ee,te,oe,se,ne,V,z,M,P,U,H,B,L,j,K,Y,G,J,y,k,A,E,I,Q,ce,pe,he;const a=R("input-school"),d=R("input-switch");return i(),u("form",{ref:"form",method:"post",action:"","accept-charset":"UTF-8",class:"grid grid-cols-3 gap-x-4",onKeyup:t[1]||(t[1]=(...W)=>e.keyup&&e.keyup(...W)),onSubmit:t[2]||(t[2]=(...W)=>e.handleSubmit&&e.handleSubmit(...W))},[ot,o("input",{type:"hidden",name:"event",value:e.event},null,8,st),o("input",{type:"hidden",name:"CRAFT_CSRF_TOKEN",value:e.csrf},null,8,nt),o("input",{type:"hidden",name:"attendeeId",value:(s=(v=(h=e.attendeeInput)==null?void 0:h.id)!=null?v:(c=e.values)==null?void 0:c.id)!=null?s:""},null,8,lt),o("div",null,[Z(a,{values:e.values,onSchoolSelect:e.handleSchoolSelect},null,8,["values","onSchoolSelect"]),o("label",at,[rt,o("input",{name:"name",value:(f=(b=(S=e.attendeeInput)==null?void 0:S.name)!=null?b:(w=e.values)==null?void 0:w.name)!=null?f:"",class:x(["block w-full px-2 py-2 text-sm text-gray-600 appearance-none box-border bg-gray-100 rounded-lg",((m=e.attendeeFormErrors)==null?void 0:m.name)?"border-solid border-red-300":"border-solid border-gray-100"]),placeholder:"Enter the name of the attendee"},null,10,dt)]),o("label",it,[ut,o("select",{name:"jobRole",value:(te=(ee=(T=e.attendeeInput)==null?void 0:T.jobRole)!=null?ee:(O=e.values)==null?void 0:O.jobRole)!=null?te:"",class:x(["block h-10 px-1 rounded-md border-none bg-gray-100 w-full",((oe=e.attendeeFormErrors)==null?void 0:oe.jobRole)?"border-solid border-red-300":""])},ht,10,ct)]),o("label",bt,[mt,o("input",{name:"email",value:(z=(V=(se=e.attendeeInput)==null?void 0:se.email)!=null?V:(ne=e.values)==null?void 0:ne.email)!=null?z:"",class:x(["block w-full px-2 py-2 text-sm text-gray-600 appearance-none box-border bg-gray-100 rounded-lg",((M=e.attendeeFormErrors)==null?void 0:M.email)?"border-solid border-red-300":"border-solid border-gray-100"]),placeholder:"Enter the email of the attendee"},null,10,vt)])]),o("div",null,[o("label",gt,[ft,o("select",{name:"days",value:(B=(H=(P=e.attendeeInput)==null?void 0:P.days)!=null?H:(U=e.values)==null?void 0:U.days)!=null?B:1,class:x(["block h-10 px-1 rounded-md border-none w-40 bg-gray-100",((L=e.attendeeFormErrors)==null?void 0:L.days)?"border-solid border-red-300":""])},wt,10,yt)]),o("label",$t,[xt,Z(d,{name:"newsletter",checked:(G=(Y=(j=e.attendeeInput)==null?void 0:j.newsletter)!=null?Y:(K=e.values)==null?void 0:K.newsletter)!=null?G:0},null,8,["checked"])]),o("label",_t,[St,Z(d,{name:"approved",checked:(E=(k=(J=e.attendeeInput)==null?void 0:J.approved)!=null?k:(y=e.values)==null?void 0:y.approved)!=null?E:((A=e.urn)==null?void 0:A.length)>0?1:0},null,8,["checked"]),((he=(ce=(I=e.attendeeInput)==null?void 0:I.orgUrn)!=null?ce:(Q=e.values)==null?void 0:Q.orgUrn)!=null?he:((pe=e.urn)==null?void 0:pe.length)>0)?(i(),u("p",At,[Ct,o("a",{href:`https://get-information-schools.service.gov.uk/Establishments/Establishment/Details/${e.urn}`,class:"text-blue-600 underline",target:"_blank"},"government establishment data",8,Ft)])):_("",!0)])]),o("div",null,[o("div",Et,[It,o("button",Dt,[e.loading?(i(),u("svg",Tt,Rt)):_("",!0),Vt]),zt,o("span",{role:"button",class:"inline-block bg-red-300 text-red-800 font-bold mt-2 py-2 px-3 text-sm rounded-lg cursor-pointer",onClick:t[0]||(t[0]=(...W)=>e.hideForm&&e.hideForm(...W))},"Cancel")])])],544)}var ue=D(tt,[["render",Mt]]);const Pt=C({components:{"form-attendee":ue},props:{csrf:{type:String,required:!0},attendee:{type:Object,required:!0},show:{type:Boolean,required:!0}},setup(e,{emit:t}){const l=q(),{showForm:n,attendeeSuccess:r}=N(l);return{showForm:n,handleCancel:()=>{t("hidePopup")},handleDelete:()=>{let d={};d.CRAFT_CSRF_TOKEN=e.csrf,d.action="actions/craft-attendees/training/delete",d.attendeeId=e.attendee.id,l.deleteAttendee(d)}}}}),Ut={class:"max-h-screen text-center overflow-auto fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-72"},Ht={class:"bg-white p-6 rounded-xl mb-10"},Bt=o("h3",{class:"text-lg"},"Delete attendee",-1),Lt={class:"flex justify-center"};function jt(e,t,l,n,r,p){return i(),u("div",{class:x(["transition-all duration-500 delay-50 ease-in-out fixed left-0 top-0 w-screen h-screen",e.show?"z-[100] opacity-100 bg-gray-900 bg-opacity-50":"z-0 opacity-0 pointer-events-none"])},[o("div",Ut,[o("div",Ht,[Bt,o("div",Lt,[o("button",{onClick:t[0]||(t[0]=(...a)=>e.handleDelete&&e.handleDelete(...a)),class:"block bg-emerald-300 text-emerald-800 font-bold mt-2 py-2 px-3 text-sm rounded-lg cursor-pointer"}," Confirm "),o("button",{onClick:t[1]||(t[1]=(...a)=>e.handleCancel&&e.handleCancel(...a)),class:"block bg-red-300 text-red-800 font-bold mt-2 py-2 px-3 text-sm rounded-lg cursor-pointer"}," Cancel ")])])])],2)}var Kt=D(Pt,[["render",jt]]);const Yt=C({components:{"form-attendee":ue,"popup-delete-attendee":Kt},props:{attendee:{type:Object,required:!0},csrf:{type:String,required:!0},event:{type:String,required:!0}},setup(e){const t=g(!1),l=g(!1),n=q(),{attendeeSuccess:r,loading:p}=N(n),a=g(!1),d=g(!1),h=g({na:"Not Applicable",support:"Support","leader-middle":"Middle leader",leader:"Leadership",teacher:"Teacher"}),c=()=>{t.value=!t.value},v=()=>{l.value=!l.value},s=()=>{d.value=!1},S=()=>{d.value=!0},w=()=>{a.value=!0},b=()=>{let m=le({},e.attendee);m.approved=1,m.CRAFT_CSRF_TOKEN=e.csrf,m.event=e.event,m.attendeeId=e.attendee.id,m.action="actions/craft-attendees/training/save",n.submitAttendee(m)},f=()=>{let m=le({},e.attendee);m.approved=0,m.CRAFT_CSRF_TOKEN=e.csrf,m.event=e.event,m.attendeeId=e.attendee.id,m.action="actions/craft-attendees/training/save",n.submitAttendee(m)};return X(()=>{a.value&&r.value&&(l.value=!1,a.value=!1)}),{expanded:t,edit:l,loading:p,showDeletePopup:d,jobRoles:h,toggle:c,handleEdit:v,submitEdit:w,handleApprove:b,handleDisapprove:f,handleDelete:S,handleHidePopup:s}}}),Gt={class:"grid grid-cols-9 xl:grid-cols-10 w-full"},Jt=o("span",{class:"inline-flex mb-0"},[o("input",{type:"checkbox"})],-1),Qt={class:"inline-flex pl-2"},Wt={class:"w-full whitespace-nowrap text-ellipsis overflow-hidden"},Xt={key:0,class:"inline-block rounded-full text-xs bg-orange-300 text-orange-800 text-bold px-4 py-1"},Zt={key:1,class:"inline-block rounded-full text-xs bg-emerald-400 text-white text-bold px-4 py-1"},Ot={key:0,class:"px-10 py-6 relative"},eo=o("h3",{class:"text-lg"},"Attendee details",-1),to={key:0,class:"absolute left-0 top-0 bg-white bg-opacity-50 z-10 w-full h-full"},oo=o("div",{class:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2"},[o("svg",{class:"animate-spin -ml-1 mr-1 mt-1 h-10 w-10 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})])],-1),so=[oo],no={key:1,class:"grid grid-cols-3 gap-x-4"},lo={class:"mb-6"},ao=o("span",{class:"text-xs font-bold text-gray-400 block"},"School or organisation",-1),ro={class:"text-base mt-1 block"},io={class:"mb-6"},uo=o("span",{class:"text-xs font-bold text-gray-400 block"},"School or organisation post code",-1),co={class:"text-base mt-1 block"},po={class:"mb-6"},ho=o("span",{class:"text-xs font-bold text-gray-400 block"},"Name of the attendee",-1),bo={class:"text-base mt-1 block"},mo={class:"mb-6"},vo=o("span",{class:"text-xs font-bold text-gray-400 block"},"Attendee's job role",-1),go={class:"text-base mt-1 block"},fo={class:"mb-6"},yo=o("span",{class:"text-xs font-bold text-gray-400 block"},"Email address of attendee",-1),ko={class:"text-base mt-1 block"},wo={class:"mb-6"},$o=o("span",{class:"text-xs font-bold text-gray-400 block"},"Attending days",-1),xo={class:"text-base mt-1 block"},_o={class:"mb-6"},So=o("span",{class:"text-xs font-bold text-gray-400 block"},"Subscribed for the newsletter?",-1),Ao={class:"text-base mt-1 block"},Co={class:"mb-6"},Fo=o("span",{class:"text-xs font-bold text-gray-400 block mb-2"},"Approved status",-1),Eo={key:0,class:"inline-block rounded-full text-xs bg-orange-300 text-orange-800 text-bold px-4 py-1"},Io={key:1,class:"inline-block rounded-full text-xs bg-emerald-400 text-white text-bold px-4 py-1"},Do={key:2,class:"text-blue-600 text-xs"},To=F("This school is a verified school. Visit the "),No=["href"],qo={class:"mb-6"},Ro=o("span",{class:"text-xs font-bold text-gray-400 block"},"Actions",-1);function Vo(e,t,l,n,r,p){var h,c,v;const a=R("form-attendee"),d=R("popup-delete-attendee");return i(),u("div",{tabindex:"0",class:x(["w-full border-l-2 border-solid",e.expanded?"border-blue-800 bg-blue-100 bg-opacity-10":"border-white"])},[o("div",Gt,[o("div",{class:"col-span-3 p-3 flex flex-nowrap items-center font-bold cursor-pointer",onClick:t[0]||(t[0]=(...s)=>e.toggle&&e.toggle(...s))},[Jt,o("span",Qt,$(e.attendee.orgName),1)]),o("div",{class:"col-span-2 box-border p-3 cursor-pointer flex items-center",onClick:t[1]||(t[1]=(...s)=>e.toggle&&e.toggle(...s))},$(e.attendee.name),1),o("div",{class:"col-span-1 xl:col-span-3 box-border p-3 cursor-pointer flex items-center",onClick:t[2]||(t[2]=(...s)=>e.toggle&&e.toggle(...s))},[o("span",Wt,$(e.attendee.email),1)]),o("div",{class:"box-border p-3 cursor-pointer flex items-center",onClick:t[3]||(t[3]=(...s)=>e.toggle&&e.toggle(...s))},$(e.attendee.days),1),o("div",{class:"box-border p-3 cursor-pointer",onClick:t[4]||(t[4]=(...s)=>e.toggle&&e.toggle(...s))},[e.attendee.approved==0||!e.attendee.approved?(i(),u("span",Xt,"Pending")):(i(),u("span",Zt,"Approved"))])]),e.expanded?(i(),u("div",Ot,[eo,e.loading?(i(),u("div",to,so)):_("",!0),e.edit?_("",!0):(i(),u("div",no,[o("div",null,[o("div",lo,[ao,o("span",ro,$(e.attendee.orgName),1)]),o("div",io,[uo,o("span",co,$(e.attendee.postCode),1)]),o("div",po,[ho,o("span",bo,$(e.attendee.name),1)]),o("div",mo,[vo,o("span",go,$((h=e.jobRoles[e.attendee.jobRole])!=null?h:"-"),1)]),o("div",fo,[yo,o("span",ko,$(e.attendee.email),1)])]),o("div",null,[o("div",wo,[$o,o("span",xo,$(e.attendee.days),1)]),o("div",_o,[So,o("span",Ao,$(e.attendee.newsletter==1?"Yes":"No"),1)]),o("div",Co,[Fo,e.attendee.approved==0||!e.attendee.approved?(i(),u("span",Eo,"Pending")):(i(),u("span",Io,"Approved")),((c=e.attendee)==null?void 0:c.orgUrn)?(i(),u("p",Do,[To,o("a",{href:`https://get-information-schools.service.gov.uk/Establishments/Establishment/Details/${(v=e.attendee)==null?void 0:v.orgUrn}`,class:"text-blue-600 underline",target:"_blank"},"government establishment data",8,No)])):_("",!0)])]),o("div",null,[o("div",qo,[Ro,o("button",{onClick:t[5]||(t[5]=(...s)=>e.handleEdit&&e.handleEdit(...s)),class:"block bg-gray-300 text-gray-800 mt-2 py-2 px-3 text-sm font-bold rounded-lg cursor-pointer"},"Edit"),o("button",{onClick:t[6]||(t[6]=(...s)=>e.handleDelete&&e.handleDelete(...s)),class:"block bg-red-300 text-red-800 font-bold mt-2 py-2 px-3 text-sm rounded-lg cursor-pointer"}," Delete "),e.attendee.approved==0||!e.attendee.approved?(i(),u("button",{key:0,onClick:t[7]||(t[7]=(...s)=>e.handleApprove&&e.handleApprove(...s)),class:"block bg-emerald-300 text-emerald-800 font-bold mt-2 py-2 px-3 text-sm rounded-lg cursor-pointer"}," Approve ")):(i(),u("button",{key:1,onClick:t[8]||(t[8]=(...s)=>e.handleDisapprove&&e.handleDisapprove(...s)),class:"block bg-orange-300 text-orange-800 font-bold mt-2 py-2 px-3 text-sm rounded-lg cursor-pointer"}," Reject "))])])])),e.edit?(i(),ye(a,{key:2,csrf:e.csrf,values:e.attendee,event:e.event,onHideForm:e.handleEdit,onSubmitForm:e.submitEdit},null,8,["csrf","values","event","onHideForm","onSubmitForm"])):_("",!0),Z(d,{show:e.showDeletePopup,csrf:e.csrf,attendee:e.attendee,onHidePopup:e.handleHidePopup},null,8,["show","csrf","attendee","onHidePopup"])])):_("",!0)],2)}var zo=D(Yt,[["render",Vo]]);const Mo=C({components:{"list-item-attendee":zo},props:{event:{type:String,required:!0},csrf:{type:String,required:!0}},setup(e){const t=q(),{attendees:l,loading:n,totalAttendees:r}=N(t),p=g(30),a=g(0),d=g(0),h=()=>{a.value=a.value+p.value,t.fetchAttendees(e.event,p.value,a.value)};return X(()=>{d.value=r.value-a.value-p.value}),t.fetchAttendees(e.event,p.value,a.value),{attendees:l,loading:n,offset:a,totalAttendees:r,remainingEntries:d,handleLoadMore:h}}}),Po=o("div",{class:"grid grid-cols-9 xl:grid-cols-10 bg-gray-100 py-2"},[o("div",{class:"col-span-3 p-3 text-left text-xs font-semibold text-gray-600 uppercase flex flex-nowrap items-center"},[o("span",{class:"inline-flex mb-0"},[o("input",{type:"checkbox",indeterminate:"true"})]),o("span",{class:"inline-flex pl-2"},"School / Organisation")]),o("div",{class:"col-span-2 p-3 text-left text-xs font-semibold text-gray-600 uppercase"}," Name of attendee "),o("div",{class:"col-span-1 xl:col-span-3 p-3 text-left text-xs font-semibold text-gray-600 uppercase"}," Email "),o("div",{class:"p-3 text-left text-xs font-semibold text-gray-600 uppercase"}," Days "),o("div",{class:"p-3 text-left text-xs font-semibold text-gray-600 uppercase"}," Status ")],-1),Uo={class:"rounded-xl bg-white overflow-hidden min-h-16"},Ho={key:0,class:"w-full pt-2"},Bo={key:0,class:"animate-spin ml-4 mt-5 mb-3 h-6 w-6 text-gray-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Lo=o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),jo=o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),Ko=[Lo,jo],Yo={key:1,class:"p-6"},Go={class:"ml-4 mt-4 relative text-center"},Jo={class:"inline-block text-gray-500 absolute left-0 top-1/2 -translate-y-1/2"};function Qo(e,t,l,n,r,p){var d;const a=R("list-item-attendee");return i(),u(re,null,[Po,o("div",Uo,[e.attendees&&e.attendees.length>0?(i(),u("div",Ho,[(i(!0),u(re,null,ge(e.attendees,(h,c)=>(i(),u("article",{class:x([e.attendees.length-1!==c?"border-b border-gray-100 border-solid":""])},[Z(a,{event:e.event,csrf:e.csrf,attendee:h},null,8,["event","csrf","attendee"])],2))),256)),e.loading?(i(),u("svg",Bo,Ko)):_("",!0)])):_("",!0),(!e.attendees||e.attendees.length===0)&&!e.loading?(i(),u("p",Yo,"There are currently no attendees for this event")):_("",!0)]),o("div",Go,[o("span",Jo,"Total results: "+$(!e.attendees||e.attendees.length>0?(d=e.attendees)==null?void 0:d.length:"0"),1),o("button",{class:x(["bg-gray-300 text-gray-800 font-bold py-2 px-3 text-sm rounded-lg cursor-pointer",e.remainingEntries>0?"":"opacity-0 pointer-events-none"]),onClick:t[0]||(t[0]=(...h)=>e.handleLoadMore&&e.handleLoadMore(...h))},"Load more ("+$(e.remainingEntries)+")",3)])],64)}var Wo=D(Mo,[["render",Qo]]);const Xo=C({components:{"form-attendee":ue},props:{csrf:{type:String,required:!0},event:{type:String,required:!0}},setup(){const e=q(),{showForm:t,attendeeSuccess:l}=N(e),n=()=>{e.setShowFrom(!1)};return X(()=>{l.value&&n()}),{showForm:t,hideForm:n}}}),Zo={class:"max-h-screen overflow-auto fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-3/4 max-w-4xl"},Oo={class:"bg-white p-6 rounded-xl mb-10"},es=o("h3",{class:"text-lg"},"Add attendee",-1);function ts(e,t,l,n,r,p){const a=R("form-attendee");return i(),u("div",{class:x(["transition-all duration-500 delay-50 ease-in-out fixed left-0 top-0 w-screen h-screen",e.showForm?"z-[100] opacity-100 bg-gray-900 bg-opacity-50 poiner-events-all":"z-0 opacity-0 pointer-events-none"])},[o("div",Zo,[o("div",Oo,[es,e.showForm?(i(),ye(a,{key:0,csrf:e.csrf,event:e.event,onHideForm:e.hideForm},null,8,["csrf","event","onHideForm"])):_("",!0)])])],2)}var os=D(Xo,[["render",ts]]);const ss=C({components:{"button-add":De,"popup-add-attendee":os,"list-attendees":Wo}}),ns=async()=>{const e=Ce(le({},ss));e.use(Fe()),e.mount("#training")};ns().then(e=>{});
//# sourceMappingURL=attendees.ab41cb04.js.map

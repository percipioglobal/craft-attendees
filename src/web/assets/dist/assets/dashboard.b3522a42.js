/* empty css            */import{A as B,B as M,d as f,s as k,f as P,H as L,c as g,o as i,p as Y,r as v,w as O,l as y,a as l,t as _,m as F,I as H,k as S,J as j,z as m,b,n as N,F as q,E as R,G as U}from"./vendor.bd85c310.js";import{_ as $}from"./plugin-vue_export-helper.21dcd24c.js";import{u as G}from"./trainings.96c469cc.js";var I,T;const J=(T=(I=window==null?void 0:window.Attendee)==null?void 0:I.cpUrl)!=null?T:"https://researchschool.org.uk/cp";var z,V;const K=(V=(z=window==null?void 0:window.Attendee)==null?void 0:z.csrf)!=null?V:"",x=B("trainings",{state:()=>({events:null,attendees:null,unverifiedAttendees:null,followOnSupport:null,followOnSupportOptions:null,totals:[],period:3,site:"main",loading:!1}),actions:{fetchEvents(e){const s=this;this.loading=!0;const n=this.site,p=this.period,c={CRAFT_CSRF_TOKEN:K,site:n,period:p};M({method:"post",url:`${J}/actions/craft-attendees/dashboard/events`,data:c}).then(function(t){var o,a,r,d,h,u;s.loading=!1,s.events=(o=t==null?void 0:t.data)==null?void 0:o.events,s.attendees=(a=t==null?void 0:t.data)==null?void 0:a.attendees,s.unverifiedAttendees=(r=t==null?void 0:t.data)==null?void 0:r.unverified_attendees,s.followOnSupport=(d=t==null?void 0:t.data)==null?void 0:d.follow_on_support,s.followOnSupportOptions=(h=t==null?void 0:t.data)==null?void 0:h.follow_on_support_options,s.totals=(u=t==null?void 0:t.data)==null?void 0:u.totals})}}}),Q=f({setup(){const e=x(),{loading:s,period:n}=k(e);return{loading:s,period:n,handlePeriodChanged:c=>{e.period=parseInt(c.currentTarget.value),e.fetchEvents()}}}}),W=["disabled"],X=Y('<option value="2022">Academic Year (2021/22)</option><option value="2021">Academic Year (2020/21)</option><option value="2020">Academic Year (2019/20)</option><option value="3">Last 3 months</option><option value="6">Last 6 months</option>',5),Z=[X];function ee(e,s,n,p,c,t){return P((i(),g("select",{name:"period",class:"block h-10 px-1 rounded-md bg-gray-300 border-gray-300","onUpdate:modelValue":s[0]||(s[0]=o=>e.period=o),disabled:e.loading,onChange:s[1]||(s[1]=(...o)=>e.handlePeriodChanged&&e.handlePeriodChanged(...o))},Z,40,W)),[[L,e.period]])}var te=$(Q,[["render",ee]]);const oe=f({components:{dropdown:te},setup(){const e=x(),{loading:s,period:n}=k(e),p=v(""),c=v("");return O(()=>{if(n.value)if(n.value<12){let t=new Date;c.value=t.getDate()+" "+t.toLocaleString("default",{month:"long"})+" "+t.getFullYear(),t.setMonth(t.getMonth()-n.value),p.value=t.getDate()+" "+t.toLocaleString("default",{month:"long"})+" "+t.getFullYear()}else{let t=new Date(`31 july ${n.value}`),o=new Date(`01 september ${n.value-1}`);c.value=t.getDate()+" "+t.toLocaleString("default",{month:"long"})+" "+t.getFullYear(),p.value=o.getDate()+" "+o.toLocaleString("default",{month:"long"})+" "+o.getFullYear()}}),{start:p,end:c,loading:s}}}),se={class:"flex w-full sticky z-20 bg-gray-100 bg-opacity-70 py-4 backdrop-blur",style:{top:"50px"}},ae={class:"text-xl font-bold inline-block flex-grow",style:{"margin-bottom":"0!important"}},ne=S("Showing data from "),le=S(" to "),re={style:{"margin-top":"0!important"}};function ie(e,s,n,p,c,t){const o=y("dropdown");return i(),g("div",se,[l("p",ae,[ne,l("strong",null,_(e.start),1),le,l("strong",null,_(e.end),1)]),l("div",re,[F(o),H(e.$slots,"default")])])}var ce=$(oe,[["render",ie]]);const de=f({components:{apexchart:j},setup(){const e=v({chart:{id:"engagement-levels",stacked:!0,stackType:"100%"},plotOptions:{bar:{horizontal:!0}},theme:{palette:"palette3"},legend:{show:!1},xaxis:{labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{show:!1},colors:["#2b63eb","#113795"]}),s=v([{name:"Attendees (unverified)",data:[0]},{name:"Attendees (verified)",data:[0]}]),n=G(),{loading:p,totals:c,attendees:t,unverifiedAttendees:o}=k(n),a=v(0);v(0);const r=v(0);v(0);const d=v(0),h=v(0);return O(()=>{var u,D;if(t.value){let A=[];for(const w in t.value)A[""+t.value[w].eventId]=((u=A[""+t.value[w].eventId])!=null?u:0)+1;let C=[];for(const w in o.value)C[""+o.value[w].eventId]=((D=C[""+o.value[w].eventId])!=null?D:0)+1;r.value=Object.keys(A).length;let E=0;for(const w in C)Object.keys(A).indexOf(w)<0&&E++;a.value=Object.keys(A).length+E,r.value=t.value.length,d.value=o.value.length,h.value=(r.value/(r.value+d.value)*100).toFixed(2).replace(/[.,]00$/,""),s.value[0].data[0]=d.value,s.value[1].data[0]=r.value}}),{loading:p,chartOptions:e,series:s,totals:c,average:h,allAttendees:a,totalAttendeesAreApproved:r,totalAttendeesAreDispproved:d,attendees:t}}}),pe={class:"bg-white p-4 rounded-xl mb-4"},ue=l("p",{class:"font-bold text-lg"},"Engagement Data Completion",-1),he={key:1,class:"text-xl w-full inline-block text-center text-gray-400"},ge=S(" total training events, "),ve={key:2,class:"block relative flex items-center justify-center w-full",style:{height:"150px"}},me=l("svg",{class:"animate-spin ml-2 mt-1 h-8 w-8 text-gray-400 inline-block -mt-px",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",style:{"margin-bottom":"0!important"}},[l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),fe=[me];function ye(e,s,n,p,c,t){var a,r,d;const o=y("apexchart");return i(),g("article",pe,[ue,!e.loading&&((a=e.attendees)==null?void 0:a.length)>0?(i(),m(o,{key:0,height:"150",type:"bar",options:e.chartOptions,series:e.series},null,8,["options","series"])):b("",!0),!e.loading&&((r=e.attendees)==null?void 0:r.length)===0?(i(),g("p",he,"There is no data to preview")):b("",!0),l("span",{class:N(["block w-full text-center py-2",e.loading||((d=e.attendees)==null?void 0:d.length)===0?"opacity-0":""])},[l("strong",null,_(e.totals.events),1),ge,l("strong",null,_(e.allAttendees),1),S(" have attendees and ("+_(e.average)+"%) are verified.",1)],2),e.loading?(i(),g("span",ve,fe)):b("",!0)])}var _e=$(de,[["render",ye]]);const be=f({props:{value:{type:Number,required:!0},type:{type:String,required:!0},average:{type:Number,required:!0},description:{type:String,required:!0}}}),$e={class:"bg-white rounded-xl p-4"},we={class:"flex items-end pb-2",style:{"align-items":"end"}},ke={class:"text-6xl block text-blue-600",style:{"margin-bottom":"0!important"}},xe={class:"block pb-1",style:{"margin-bottom":"0!important"}},Se={class:"block pb-1 text-xs"},Ae=S("Avg. ");function Oe(e,s,n,p,c,t){return i(),g("article",$e,[l("span",we,[l("span",ke,_(e.value),1),l("span",xe,_(e.type),1)]),l("span",Se,[Ae,l("strong",null,_(e.average),1),S(" "+_(e.description),1)])])}var Fe=$(be,[["render",Oe]]);const Ce=f({setup(){const e=x(),{loading:s}=k(e);return{loading:s}}}),je={class:"bg-white rounded-xl p-4"},Ne={key:0},De=l("span",{class:"animate-pulse flex items-end pb-2",style:{"align-items":"end"}},[l("span",{class:"text-6xl block text-blue-600 bg-blue-600 bg-opacity-10 rounded-md",style:{"margin-bottom":"0!important"}},"\xA0\xA0\xA0\xA0\xA0\xA0"),l("span",{class:"block pb-1 bg-gray-200 bg-opacity-50 flex-grow rounded-md",style:{"margin-bottom":"0!important"}},"\xA0")],-1),Ee=l("span",{class:"animate-pulse block pb-1 text-xs bg-gray-200 bg-opacity-50 rounded-md"},"\xA0",-1),Ie=[De,Ee],Te={key:1,class:"flex items-center justify-center w-full h-full font-bold"};function ze(e,s,n,p,c,t){return i(),g("article",je,[e.loading?(i(),g("div",Ne,Ie)):(i(),g("div",Te," There is no data to preview "))])}var Ve=$(Ce,[["render",ze]]);const Be=f({components:{stat:Fe,"stat-empty":Ve},setup(){const e=x(),{loading:s,events:n,attendees:p,period:c,totals:t}=k(e),o=v(0),a=()=>{const u=parseFloat(o.value/t.value.events);return isNaN(u)?0:parseFloat(u).toFixed(2).replace(/[.,]00$/,"")},r=()=>(Math.ceil(n.value.length/c.value),isNaN(n)?0:n.toFixed(2).replace(/[.,]00$/,"")),d=()=>{const u=t.value.attendees/t.value.events;return isNaN(u)?0:parseFloat(u).toFixed(2).replace(/[.,]00$/,"")},h=()=>{const u=t.value.schools/t.value.events;return isNaN(u)?0:parseFloat(u).toFixed(2).replace(/[.,]00$/,"")};return O(()=>{p.value&&(o.value=p.value.filter(u=>u.priority==1).length)}),{loading:s,events:n,attendees:p,totals:t,priority:o,averageEvents:r,averageAttendees:d,averageSchools:h,averagePrioritySchools:a}}}),Me={class:"grid grid-cols-2 xl:grid-cols-4 gap-4"};function Pe(e,s,n,p,c,t){var r,d,h;const o=y("stat"),a=y("stat-empty");return i(),g("div",Me,[e.events&&!e.loading?(i(),m(o,{key:0,value:parseInt((r=e.totals.events)!=null?r:e.events.length),average:parseFloat(e.averageEvents()),type:"events",description:"trainings per month"},null,8,["value","average"])):(i(),m(a,{key:1})),e.attendees&&!e.loading?(i(),m(o,{key:2,value:parseInt((d=e.totals.attendees)!=null?d:e.attendees.length),average:parseFloat(e.averageAttendees()),type:"attendees",description:"attendees per training"},null,8,["value","average"])):(i(),m(a,{key:3})),e.attendees&&!e.loading?(i(),m(o,{key:4,value:parseInt((h=e.totals.schools)!=null?h:0),average:parseFloat(e.averageSchools()),type:"schools",description:"schools per training"},null,8,["value","average"])):(i(),m(a,{key:5})),e.attendees&&!e.loading?(i(),m(o,{key:6,value:e.priority,average:parseFloat(e.averagePrioritySchools()),type:"priority schools",description:"priority schools per training"},null,8,["value","average"])):(i(),m(a,{key:7}))])}var Le=$(Be,[["render",Pe]]);const Ye=f({components:{apexchart:j},setup(){const e=v({chart:{id:"engagement-levels",stacked:!0,stackType:"100%"},plotOptions:{bar:{horizontal:!0}},theme:{palette:"palette3"},legend:{position:"top"},xaxis:{labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{show:!1},colors:["#2b63eb","#113795","#07205b"]}),s=v([{name:"Engaged (1 module)",data:[0]},{name:"Sustained (2 modules)",data:[0]},{name:"Embedded (3+ modules)",data:[0]}]),n=x(),{loading:p,attendees:c}=k(n);return O(()=>{if(c.value){const t=c.value.reduce(function(o,a){return o[a.days]=o[a.days]||[],o[a.days].push(a),o},Object.create(null));for(const o in Object.keys(t)){const a=o<3?o:2;s.value[a].data[0]=parseInt(s.value[a].data[0])+Object.values(t)[o].length}}}),{loading:p,chartOptions:e,series:s,attendees:c}}}),He={class:"bg-white p-4 rounded-xl mb-4"},qe=l("p",{class:"font-bold text-lg"},"Engagement level",-1),Re={key:1,class:"text-xl w-full inline-block text-center text-gray-400"},Ue={key:2,class:"block relative flex items-center justify-center w-full",style:{height:"150px"}},Ge=l("svg",{class:"animate-spin ml-2 mt-1 h-8 w-8 text-gray-400 inline-block -mt-px",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",style:{"margin-bottom":"0!important"}},[l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),Je=[Ge];function Ke(e,s,n,p,c,t){var a,r,d;const o=y("apexchart");return i(),g("article",He,[qe,!e.loading&&((a=e.attendees)==null?void 0:a.length)>0?(i(),m(o,{key:0,height:"150",type:"bar",options:e.chartOptions,series:e.series},null,8,["options","series"])):b("",!0),!e.loading&&((r=e.attendees)==null?void 0:r.length)===0?(i(),g("p",Re,"There is no data to preview")):b("",!0),l("span",{class:N(["block w-full text-center py-2",e.loading||((d=e.attendees)==null?void 0:d.length)===0?"opacity-0":""])},"Showing the split of engagement levels across all events in this time period",2),e.loading?(i(),g("span",Ue,Je)):b("",!0)])}var Qe=$(Ye,[["render",Ke]]);const We=f({components:{apexchart:j},setup(e){const s=v({chart:{id:"follow-on-support"},plotOptions:{bar:{horizontal:!0,height:"10%"}},theme:{palette:"palette3"},legend:{position:"top"},xaxis:{categories:[]},yaxis:{labels:{style:{fontSize:"14px",fontFamily:'system-ui,BlinkMacSystemFont,-apple-system,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif'}}},colors:["#2b63eb","#113795","#07205b"]}),n=v([{name:"Follow on support",data:[]}]),p=x(),{loading:c,followOnSupport:t,followOnSupportOptions:o}=k(p);return O(()=>{var a;if(t.value&&t.value){const r=t.value.reduce(function(h,u){return h[u.optionId]=h[u.optionId]||[],h[u.optionId].push(u),h},Object.create(null));let d=[];for(const h in r)d.push((a=o.value.find(u=>u.id==h))==null?void 0:a.name);s.value.xaxis.categories=d,n.value[0].data=[],Object.values(r).forEach((h,u)=>{n.value[0].data.push(h.length)})}}),{chartOptions:s,series:n,loading:c,followOnSupport:t}}}),Xe={class:"bg-white p-4 rounded-xl mb-4"},Ze=l("p",{class:"font-bold text-lg"},"Follow on support",-1),et={key:1,class:"text-xl w-full inline-block text-center text-gray-400 flex items-center justify-center w-full block",style:{height:"800px"}},tt=l("span",null,"There is no data to preview",-1),ot=[tt],st={key:2,class:"block relative flex items-center justify-center w-full",style:{height:"800px"}},at=l("svg",{class:"animate-spin ml-2 mt-1 h-8 w-8 text-gray-400 inline-block -mt-px",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",style:{"margin-bottom":"0!important"}},[l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),nt=[at];function lt(e,s,n,p,c,t){var a,r,d;const o=y("apexchart");return i(),g("article",Xe,[Ze,!e.loading&&((a=e.followOnSupport)==null?void 0:a.length)>0?(i(),m(o,{key:0,height:"800px",type:"bar",options:e.chartOptions,series:e.series},null,8,["options","series"])):b("",!0),!e.loading&&((r=e.followOnSupport)==null?void 0:r.length)===0?(i(),g("p",et,ot)):b("",!0),l("span",{class:N(["block w-full text-center py-2",e.loading||((d=e.followOnSupport)==null?void 0:d.length)===0?"opacity-0":""])},"Showing what types of follow on support have been offered.",2),e.loading?(i(),g("span",st,nt)):b("",!0)])}var rt=$(We,[["render",lt]]);const it=f({components:{"stats-completion":_e,"stats-figures":Le,"stats-levels":Qe,"stats-support":rt},props:{site:{type:String,required:!0}},setup(e){const s=x();s.site=e.site=="*"?2:e.site,s.fetchEvents(e.ids)}});function ct(e,s,n,p,c,t){const o=y("stats-figures"),a=y("stats-levels"),r=y("stats-support"),d=y("stats-completion");return i(),g(q,null,[F(o),F(a),F(r),F(d)],64)}var dt=$(it,[["render",ct]]);const pt=f({components:{"header-dashboard":ce,"stats-dashboard":dt}}),ut=async()=>{const e=R(pt);return e.use(U()),e.mount("#dashboard")};ut().then(e=>{});
//# sourceMappingURL=dashboard.b3522a42.js.map

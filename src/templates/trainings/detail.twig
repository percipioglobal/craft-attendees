{# @var craft \craft\web\twig\variables\CraftVariable #}
{#
/**
 * craft-attendees plugin for Craft CMS 3.x
 *
 * craft-attendees index.twig
 *
 * @author    percipiolondon
 * @copyright Copyright (c) 2021 percipiolondon
 * @link      https://percipio.london
 * @package   Craftattendees
 * @since     1.0.0
 */
#}

{% extends "craft-attendees/_layouts/_cp" %}
{% import "_includes/forms" as forms %}

{% set scriptTagOptions = {
    'depends': [
        'percipiolondon\\attendees\\assetbundles\\craftattendees\\AttendeesAsset'
    ],
} %}

{% set pluginCpUrl = url('craft-attendees') %}
{% set settings = craft.app.getPlugins().getPlugin('craft-attendees').getSettings() %}
{% set selectedSubnavItem = 'trainings' %}
{% set eventTypes = {
    'onlineEvent': 'Online Event',
    'locationEvent': 'Location Event',
    'hybridEvent': 'Hybrid Event'
} %}
{#{%- set fullPageForm = true -%}#}

{% set title = "Trainings | Attendees" %}

{% set crumbs = [
    { label: "Attendees", url: url(pluginCpUrl) },
    { label: "Trainings"|t('craft-attendees'), url: url(pluginCpUrl ~ '/trainings') },
] %}

{# Content that should appear in the page header#}
{% block actionButton %}
    <a href="{{ cpUrl() ~ '/' ~ settings.eventSection ~ '/' ~ event.slug }}" class="btn">{{ "Edit Event"|t('craft-attendees') }}</a>
{% endblock %}

{# The content of the CP Section#}
{% set content %}

    <div id="training">
        <h1>{{ event.title }}</h1>
        <h6 class="inline-block mb-4 space-x-2 -mt-2">
            <span class="inline-block rounded-full bg-gray-700 text-white px-4 py-2">{{ eventTypes[event.type.handle] ?? '' }}</span>
            <span class="inline-block rounded-full bg-gray-700 text-white px-4 py-2">{{ event.eventCategories.one().title ?? '' }}</span>
        </h6>
        <p>{{ event.description }}</p>

        <section class="rounded-2xl bg-gray-100 p-6 mt-10">
            <div class="w-full flex field">
                <div class="heading flex-grow">
                    <label class="text-xl inline-block w-full">Attendees</label>
                    <span>You can import a .csv file or add a new attendee in the actions on the right.</span>
                </div>
                <a href="#" class="bg-gray-300 text-gray-800 font-bold py-2 px-3 text-sm rounded-lg">{{ "Import"|t('craft-attendees') }}</a>
                <button-add label="{{ "Add"|t('craft-attendees') }}"></button-add>
            </div>

            <popup-add-attendee csrf="{{ craft.app.request.csrfToken }}" event="{{ event.id }}"></popup-add-attendee>

            <div class="grid grid-cols-11 bg-gray-100 py-2">
                <div class="col-span-3 p-3 text-left text-xs font-semibold text-gray-600 uppercase flex flex-nowrap items-center">
                    <span class="inline-flex mb-0"><input type="checkbox" indeterminate="true"/></span>
                    <span class="inline-flex pl-2">School / Organisation</span>
                </div>
                <div class="col-span-2 p-3 text-left text-xs font-semibold text-gray-600 uppercase">
                    Name of attendee
                </div>
                <div class="col-span-3 p-3 text-left text-xs font-semibold text-gray-600 uppercase">
                    Email
                </div>
                <div class="p-3 text-left text-xs font-semibold text-gray-600 uppercase">
                    Days
                </div>
                <div class="p-3 text-left text-xs font-semibold text-gray-600 uppercase">
                    Status
                </div>
                <div class="p-3 text-left text-xs font-semibold text-gray-600 uppercase">&nbsp;</div>
            </div>

            <list-attendees csrf="{{ craft.app.request.csrfToken }}" event="{{ event.id }}"></list-attendees>
        </section>

{#        <table class="table-auto w-full">#}
{#            <thead class="bg-gray-100">#}
{#                <tr>#}
{#                    <th class="px-3">#}
{#                        <span class="py-3 text-left text-xs font-semibold text-gray-600 uppercase">#}
{#                            School / Organisation#}
{#                        </span>#}
{#                    </th>#}
{#                    <th class="px-3">#}
{#                        <span class="py-3 text-left text-xs font-semibold text-gray-600 uppercase">#}
{#                            Post code#}
{#                        </span>#}
{#                    </th>#}
{#                    <th class="px-3">#}
{#                        <span class="py-3 text-left text-xs font-semibold text-gray-600 uppercase">#}
{#                            Name of attendee#}
{#                        </span>#}
{#                    </th>#}
{#                    <th class="px-3">#}
{#                        <span class="py-3 text-left text-xs font-semibold text-gray-600 uppercase">#}
{#                            Email#}
{#                        </span>#}
{#                    </th>#}
{#                    <th class="px-3">#}
{#                        <span class="py-3 text-left text-xs font-semibold text-gray-600 uppercase">#}
{#                            Days Attended#}
{#                        </span>#}
{#                    </th>#}
{#                    <th class="px-3">#}
{#                        <span class="py-3 text-left text-xs font-semibold text-gray-600 uppercase">#}
{#                            Newsletter#}
{#                        </span>#}
{#                    </th>#}
{#                    <th class="px-3">#}
{#                        <span class="py-3 text-left text-xs font-semibold text-gray-600 uppercase">#}
{#                            Actions#}
{#                        </span>#}
{#                    </th>#}
{#                </tr>#}
{#            </thead>#}
{#            <tbody>#}
{#                <tr>#}
{#                    <td>#}
{#                        <div class="border-b-2 border-gray-600">The Sliding Mr. Bones (Next Stop, Pottersville)</div>#}
{#                    </td>#}
{#                    <td>#}
{#                        <div class="border-b-2 border-gray-600">Malcolm Lockyer</div>#}
{#                    </td>#}
{#                    <td>#}
{#                        <div class="border-b-2 border-gray-600">1961</div>#}
{#                    </td>#}
{#                    <td>#}
{#                        <div class="border-b-2 border-gray-600">1961</div>#}
{#                    </td>#}
{#                    <td>#}
{#                        <div class="border-b-2 border-gray-600">1961</div>#}
{#                    </td>#}
{#                    <td>#}
{#                        <div class="border-b-2 border-gray-600">1961</div>#}
{#                    </td>#}
{#                    <td>#}
{#                        <div class="border-b-2 border-gray-600">x</div>#}
{#                    </td>#}
{#                </tr>#}
{#            </tbody>#}
{#        </table>#}

{#        {{ forms.editableTableField({#}
{#            id: 'attendee-data',#}
{#            class: '',#}
{#            name: 'attendee[data]',#}
{#            label: 'Attendees' |t,#}
{#            instructions: "Use <b>+</b> button below to add a row for each attendee, if multiple people from the same organisation participated, each should be added on a new line." |t,#}
{#            required: false,#}
{#            static: false,#}
{#            cols: {#}
{#                status: {#}
{#                    class: "thin action rsn-status",#}
{#                    heading: "" |t,#}
{#                    type: "singleline",#}
{#                    value: 0,#}
{#                },#}
{#                school: {#}
{#                    class: "action rsn-autocomplete orderable",#}
{#                    heading: "School / Organisation" |t,#}
{#                    type: "singleline",#}
{#                    placeholder: "click to activate",#}
{#                    width: '35%',#}
{#                },#}
{#                schooldata: {#}
{#                    class: "rsn-data",#}
{#                    type: "hidden",#}
{#                },#}
{#                postcode: {#}
{#                    class: "rsn-postcode orderable",#}
{#                    heading: "Post code" |t,#}
{#                    type: "text",#}
{#                    width: '10%',#}
{#                },#}
{#                name: {#}
{#                    class: "rsn-name orderable",#}
{#                    heading: "Name of attendee" |t,#}
{#                    type: "text",#}
{#                    width: '20%',#}
{#                },#}
{#                email: {#}
{#                    class: "rsn-email",#}
{#                    heading: "Email" |t,#}
{#                    type: "text",#}
{#                    width: '25%',#}
{#                },#}
{#                role: {#}
{#                    class: "rsn-role",#}
{#                    heading: "Role" |t,#}
{#                    type: "select",#}
{#                    options: {#}
{#                        "": "Select one",#}
{#                        "na": "Not Applicable",#}
{#                        "support": "Support Staff" |t,#}
{#                        "leader-middle": "Middle leader" |t,#}
{#                        "leader": "Leadership" |t,#}
{#                        "teacher": "Teacher" |t,#}
{#                    },#}
{#                },#}
{#                attendance: {#}
{#                    class: "rsn-attendance",#}
{#                    heading: "Days Attended" |t,#}
{#                    type: "select",#}
{#                    options: {#}
{#                        "1": "1",#}
{#                        "2": "2",#}
{#                        "3": "3",#}
{#                        "4": "4",#}
{#                        "5": "5",#}
{#                        "6": "6",#}
{#                        "7": "7",#}
{#                        "8": "8",#}
{#                        "9": "9",#}
{#                        "10": "10",#}
{#                    },#}
{#                },#}
{#                optin: {#}
{#                    class: "rsn-mailing",#}
{#                    heading: "Newsletter" |t,#}
{#                    type: "lightswitch",#}
{#                    width: "1%",#}
{#                },#}
{#            },#}
{#            addRowLabel: "Add another attendee" |t,#}
{#        }) }}#}
    </div>

    {{ craft.attendees.register('/src/js/attendees.ts', false, scriptTagOptions) }}
{% endset %}
